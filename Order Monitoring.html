
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset=UTF-8><meta content="width=device-width,initial-scale=1"name=viewport><title>Order Monitoring Dashboard</title><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css rel=stylesheet>
 <style>
 .sidebar-btn,.upload-zone{text-align:center;cursor:pointer}.apple-logout-btn,.apple-table{font-family:-apple-system,BlinkMacSystemFont,"San Francisco","Segoe UI",Roboto,Helvetica,Arial,sans-serif}.apple-style-report-table,.apple-table{border-collapse:separate;border-spacing:0}.apple-style-report-table td.remarks-cell,td.remarks-cell{white-space:pre-wrap;max-width:100%;word-break:break-word}:root{--apple-blue:#007aff;--sidebar-bg:#f9fafc;--sidebar-border:#dce1e6;--text-main:#1c1c1e;--text-muted:#8e8e93;--highlight:#0a84ff;--card-bg:#ffffff;--card-shadow:rgba(0, 0, 0, 0.06);--hover-shadow:rgba(0, 0, 0, 0.1);--transition-fast:0.25s ease}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;background-color:#f2f4f8;color:var(--text-main);margin:0;padding:0;overflow-x:hidden}.sidebar{position:fixed;top:56px;left:0;width:260px;height:calc(100vh - 56px);background:rgba(255,255,255,.65);backdrop-filter:blur(20px);border-right:1px solid rgba(200,200,200,.3);padding:2rem 1.5rem;display:flex;flex-direction:column;gap:1.25rem;box-shadow:2px 0 12px rgba(0,0,0,.06);z-index:999;overflow-y:auto;transition:transform .3s;transform:translateX(-100%)}.sidebar-title{font-size:1.25rem;font-weight:700;color:#1c1c1e;margin-bottom:1.5rem;letter-spacing:.5px;padding-left:2px}.sidebar.active{transform:translateX(0)}.sidebar.slide-out-left{transform:translateX(-100%)}#mainContent.shifted{margin-left:270px;transition:margin-left .3s}.sidebar-btn{background:linear-gradient(135deg,#007aff,#0a84ff);border:none;padding:.7rem 1.4rem;border-radius:18px;color:#fff;font-weight:600;font-size:1rem;box-shadow:0 4px 10px rgba(0,122,255,.15);transition:.2s ease-in-out;display:flex;align-items:center;justify-content:center;gap:.5rem;white-space:nowrap}.sidebar-btn:hover{background:linear-gradient(135deg,#005ecb,#007aff);transform:translateY(-2px);box-shadow:0 6px 14px rgba(0,122,255,.25)}.sidebar-btn:active{transform:scale(.98);box-shadow:0 3px 8px rgba(0,122,255,.2)}.sidebar-btn.active{background:#004ba0;box-shadow:inset 0 0 0 2px #ffffff33}.sidebar-btn::before{content:'üõ†Ô∏è';font-size:1.1rem}.apple-footer,.main-content{transition:margin-left .3s;margin-left:0}.card-summary{background:var(--card-bg);padding:1.5rem 2rem;border-radius:16px;box-shadow:0 4px 14px var(--card-shadow);border-left:5px solid var(--highlight);transition:transform .3s,box-shadow .3s}.card-summary:hover{transform:translateY(-4px);box-shadow:0 10px 24px var(--hover-shadow)}.upload-zone{border:2px dashed #c7c7cc;background-color:#f4f4f7;padding:2rem;border-radius:12px;color:var(--text-muted);transition:all var(--transition-fast)}.upload-zone:hover{border-color:var(--highlight);color:var(--highlight);background-color:#e6f0ff}.apple-table td,.apple-table thead th{border-bottom:1px solid #1abc9c;color:#ecf0f1}.table-wrapper{max-height:500px;overflow:auto;background:#1e2a38;border-radius:16px;box-shadow:0 10px 20px rgba(0,0,0,.25);margin-top:2rem;border:1px solid #2c3e50;padding:0}.apple-card{background:#2c3e50;border-radius:16px;box-shadow:0 6px 16px rgba(0,0,0,.2);overflow:hidden;border:1px solid #34495e;transition:.3s}.apple-card-header{background:linear-gradient(to right,#2980b9,#3498db);color:#fff;padding:1rem 1.5rem;font-size:1.1rem;font-weight:600;border-bottom:1px solid rgba(255,255,255,.2);border-radius:16px 16px 0 0;text-align:left}.apple-card-body{padding:0}.apple-table-wrapper{max-height:600px;overflow:auto;border-radius:0 0 16px 16px;position:relative;z-index:1}.apple-table{width:100%;min-width:600px;font-size:.95rem;color:#ecf0f1;background:#2c3e50}.status-cancelled,.status-delivered,.status-partial,.status-pending{font-weight:600;padding:2px 10px;border-radius:20px;font-size:.85rem}.apple-table thead th{position:sticky;top:0;background:#34495e;font-weight:600;padding:.85rem 1.2rem;backdrop-filter:blur(8px);z-index:10;white-space:nowrap;text-align:left}.apple-table td:first-child,.apple-table th:first-child{position:sticky;left:0;background:#34495e;z-index:3}.apple-table thead th:first-child{z-index:11}.apple-table tbody tr{transition:background-color .2s}.apple-table tbody tr:hover{background-color:#3b536a;cursor:pointer}.apple-table tbody tr:nth-child(2n){background-color:#2f4458}.apple-table td{padding:.75rem 1.2rem;vertical-align:middle;transition:background .3s}.apple-table-wrapper::-webkit-scrollbar{height:10px;width:10px}.apple-table-wrapper::-webkit-scrollbar-thumb{background:#3498db;border-radius:10px}.apple-table-wrapper::-webkit-scrollbar-track{background:#2c3e50}.status-pending{background-color:#1abc9c;color:#1e2a38}tr.selected-row td{background-color:#1abc9c!important}tr:hover td{background-color:#3b536a!important}.chart-wrapper{height:240px}#chartCanvas,#ordersIssuedChart{width:100%!important;height:240px!important}.chart-duo{display:flex;flex-wrap:wrap;gap:20px}.chart-box{flex:1;min-width:300px}.chart-divider{width:1px;background-color:#e0e0e0;margin:0 10px}@media (max-width:992px){.chart-duo{flex-direction:column}.chart-divider{display:none}}.status-cancelled,.status-delivered,.status-partial{display:inline-block;line-height:1;white-space:nowrap}.status-delivered{color:#fff;background-color:#34c759}.status-cancelled{color:#fff;background-color:#ff3b30}.status-partial{color:#fff;background-color:#ff9500}.apple-logout-btn,.apple-style-btn{background:linear-gradient(to bottom,#f2f2f7,#d1d1d6);font-weight:500;font-size:.95rem;color:#1c1c1e}.fade-in{animation:.5s ease-in-out both fadeIn}@keyframes fadeIn{0%{opacity:0;transform:translateY(10px)}100%{opacity:1;transform:translateY(0)}}.apple-style-btn{border:1px solid #c7c7cc;border-radius:12px;padding:10px 18px;box-shadow:inset 0 1px 0 #fff,0 2px 4px rgba(0,0,0,.1);transition:.2s ease-in-out;backdrop-filter:blur(10px)}.apple-style-btn:hover{background:linear-gradient(to bottom,#e0e0e5,#c7c7cc);box-shadow:0 4px 8px rgba(0,0,0,.12);transform:translateY(-1px)}.apple-style-btn:active{background:#d1d1d6;transform:scale(.98);box-shadow:inset 0 1px 2px rgba(0,0,0,.15)}.apple-logout-btn{display:flex;align-items:center;gap:8px;padding:10px 20px;border:1px solid #c7c7cc;border-radius:12px;box-shadow:0 2px 4px rgba(0,0,0,.05);cursor:pointer;transition:.2s}.apple-logout-btn:hover{background:linear-gradient(to bottom,#e5e5ea,#c7c7cc);transform:translateY(-1px);box-shadow:0 4px 8px rgba(0,0,0,.1)}.apple-logout-btn:active{background:linear-gradient(to bottom,#d1d1d6,#a1a1aa);transform:translateY(0);box-shadow:inset 0 2px 4px rgba(0,0,0,.1)}.apple-logout-btn .icon{width:18px;height:18px;stroke:#1c1c1e}.apple-style-report-table{width:100%;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;font-size:.95rem;background:rgba(255,255,255,.75);backdrop-filter:blur(6px);border-radius:16px;overflow:hidden;box-shadow:0 8px 30px rgba(0,0,0,.08);transition:.3s}.apple-style-report-table thead th{background:linear-gradient(to bottom,#f9f9fb,#e8e8f0);color:#1c1c1e;font-weight:600;padding:16px;text-align:center;border-bottom:1px solid #d1d1d6;letter-spacing:.3px;font-size:.96rem}.apple-style-report-table tbody td{padding:14px 16px;text-align:center;border-bottom:1px solid #eaeaf0;color:#2c2c2e;vertical-align:middle;background-color:#fff;transition:background-color .2s}.apple-style-report-table tbody tr:nth-child(2n) td{background-color:#fafafa}.apple-style-report-table tbody tr:hover td{background-color:#f2f2f7;cursor:pointer}.apple-style-report-table .text-success{color:#30d158;font-weight:600}.apple-style-report-table .text-danger{color:#ff3b30;font-weight:600}.apple-style-report-table .text-warning{color:#ff9f0a;font-weight:600}.apple-style-report-table td.remarks-cell{text-align:left}.resizable-header{position:relative;display:flex;justify-content:center;align-items:center;padding-right:10px}.resizable-header::after{content:'';position:absolute;right:0;top:0;width:5px;height:100%;cursor:col-resize;user-select:none}#rrReportTableBody tr.selected-row td{background-color:#cce4ff!important}#rrReportTableBody tr:hover td{background-color:#e2f0ff!important;cursor:pointer}#supplierCheckboxes label{margin-right:10px;white-space:nowrap}.custom-modal .modal-dialog{max-width:95%;width:auto}.custom-modal .modal-content{max-height:80vh;overflow-y:auto}.custom-modal .modal-body{font-size:1.2rem;max-height:65vh}.custom-modal .table{table-layout:auto;width:100%;word-wrap:break-word}.custom-modal .table td,.custom-modal .table th{padding:.75rem;vertical-align:middle}.custom-modal .table td:first-child,.custom-modal .table th:first-child{width:30%}.custom-modal .table td:nth-child(7),.custom-modal .table th:nth-child(7){width:25%;white-space:normal;word-break:break-word}.custom-modal .table td:nth-child(2),.custom-modal .table td:nth-child(3),.custom-modal .table td:nth-child(4),.custom-modal .table td:nth-child(5),.custom-modal .table td:nth-child(6),.custom-modal .table td:nth-child(8),.custom-modal .table th:nth-child(2),.custom-modal .table th:nth-child(3),.custom-modal .table th:nth-child(4),.custom-modal .table th:nth-child(5),.custom-modal .table th:nth-child(6),.custom-modal .table th:nth-child(8){width:10%}.custom-modal .table td:nth-child(9),.custom-modal .table th:nth-child(9){display:none}.apple-footer{background:linear-gradient(to top,#f2f2f7,#fff);padding:40px 20px 20px;font-family:-apple-system,BlinkMacSystemFont,"San Francisco","Segoe UI",Roboto,Helvetica,Arial,sans-serif;color:#1c1c1e;border-top:1px solid #e5e5ea;box-shadow:0 -1px 3px rgba(0,0,0,.05)}.footer-container{max-width:1200px;margin:0 auto;text-align:center}.footer-section{margin-bottom:20px}.footer-title{font-size:1.2rem;font-weight:600;margin:0}.footer-subtext{font-size:.95rem;color:#6e6e73;margin:4px 0 0}.footer-links{margin:20px 0}.footer-links a{margin:0 12px;font-size:.95rem;color:#0071e3;text-decoration:none;transition:color .2s}.footer-links a:hover{color:#004ba0}.footer-copy{font-size:.85rem;color:#8e8e93}.main-content.shifted,.main-content.shifted~.apple-footer{margin-left:260px}
</style>
</head>
<body>
<nav class="mb-4 bg-dark navbar navbar-dark navbar-expand-lg"><div class=container-fluid><a href=# class=navbar-brand>TrackWise</a><ul class="me-auto navbar-nav"><li class=nav-item><a href=# class="nav-link active">Dashboard</a><li class=nav-item><a href="Chart project.html"class=nav-link>Charts</a><li class=nav-item><a href=# class=nav-link id=toggleSidebar>Update</a><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle"aria-expanded=false data-bs-toggle=dropdown role=button>Generate Report</a><ul class=dropdown-menu><li><a href=# class=dropdown-item id=toFollowUpBtn>To Follow-Up Report</a><li><a href=# class=dropdown-item id=statusReportBtn>Status Report</a><li><a href=# class=dropdown-item id=generateRRReportBtn>Generate RR Report</a><li><a href=# class=dropdown-item id=deliveryperformanceBtn>Delivery Performance Report</a></ul></ul><div class="dropdown ms-auto"><button class="btn btn-outline-light dropdown-toggle"type=button id=myAccountDropdown aria-expanded=false data-bs-toggle=dropdown>My Account</button><ul class="dropdown-menu dropdown-menu-end"aria-labelledby=myAccountDropdown><li><span class=dropdown-item-text><strong>Name:</strong><br><span id=userEmailDisplay>Loading...</span></span><li><hr class=dropdown-divider><li><a href=# class="dropdown-item text-danger"id=logoutBtn>Logout</a></ul></div></div></nav><div class="hidden sidebar"id=functionSidebar><h5 class=sidebar-title>Functions</h5><button class="btn btn-primary w-100 mb-3 sidebar-btn"id=btnShowUpdate>UPDATE ORDER DETAILS</button> <button class="btn btn-primary w-100 mb-3 sidebar-btn"id=btnCustomizeTable>Customize Table</button> <button class="btn btn-secondary mb-3 sidebar-btn w-100"id=btnCustomizeCharts>Customize Charts</button></div><div class=main-content id=mainContent style=padding:20px><div class="mb-4 container-fluid p-0"><div class="text-center gx-3 row"><div class="mb-3 col-md-2"><div class="card card-summary"><div class=card-body><h6>Total Orders</h6><h4 id=totalOrders>--</h4></div></div></div><div class="mb-3 col-md-2"><div class="card card-summary"><div class=card-body><h6>Delivered</h6><h4 id=deliveredOrders class=text-success>--</h4></div></div></div><div class="mb-3 col-md-2"><div class="card card-summary"><div class=card-body><h6>Cancelled</h6><h4 id=cancelledOrders class=text-danger>--</h4></div></div></div><div class="mb-3 col-md-2"><div class="card card-summary"><div class=card-body><h6>In Progress</h6><h4 id=partialOrders class=text-warning>--</h4></div></div></div><div class="mb-3 col-md-2"><div class="card card-summary"><div class=card-body><h6>Partially Delivered</h6><h4 id=partiallyDeliveredOrders class=text-info>--</h4></div></div></div></div></div><div class="mb-4 container-fluid p-0"><div class="row align-items-center gx-2"><div class="mb-2 mb-md-0 col-lg-4 col-md-6 col-sm-12"><input id=searchInput class="form-control form-control-sm"placeholder="Search Customer/Product..."></div><div class="mb-2 mb-md-0 col-lg-2 col-md-3 col-sm-6"><select id=statusFilter><option value=All>All<option value=Delivered>Delivered<option value="Partially Delivered">Partially Delivered<option value=Cancelled>Cancelled<option value="In Progress">In Progress</select></div><div class="mb-2 mb-md-0 col-lg-2 col-md-3 col-sm-6"><select id=monthSort class="form-select form-select-sm"><option value="">Sort by Month<option value=january>January<option value=february>February<option value=march>March<option value=april>April<option value=may>May<option value=june>June<option value=july>July<option value=august>August<option value=september>September<option value=october>October<option value=november>November<option value=december>December</select></div><div class="d-flex gap-2 align-items-center col-lg-4 col-md-12 flex-wrap justify-content-start mt-2 mt-lg-0"><label class="m-0 upload-zone"for=excelFile>üìÅ Upload Excel <input id=excelFile type=file accept=".xlsx, .xls"hidden></label> <button class="btn-sm apple-style-btn"id=btnDownloadExcel>üì• Download Excel</button></div></div></div><div class="mb-4 container-fluid p-0"><div class="d-flex justify-content-between chart-trio flex-wrap"><div class="mb-3 chart-box flex-grow-1 mb-md-0 me-md-3"><div class="card border-0 h-100 rounded-4 shadow-sm"><div class="card-body pb-2 pt-4 px-4"><div class="mb-3 d-flex align-items-center justify-content-between"><h5 class=mb-0 style=font-weight:600;color:#1d1d1f>Monthly Sales Overview</h5><select id=currencySelector class="form-select form-select-sm"style=max-width:150px;border-radius:12px><option value=ALL>All Currencies<option value=PHP>PHP<option value=USD>USD<option value=JPY>JPY</select></div><div class=chart-wrapper><canvas id=chartCanvas></canvas></div></div></div></div><div class="chart-divider d-md-block d-none"></div><div class="mb-3 chart-box flex-grow-1 mb-md-0 mx-md-3"><div class="card border-0 h-100 rounded-4 shadow-sm"><div class="card-body pb-2 pt-4 px-4"><h5 class=mb-3 style=font-weight:600;color:#1d1d1f>Total Orders Issued Per Month</h5><div class=chart-wrapper><canvas id=ordersIssuedChart></canvas></div></div></div></div><div class="chart-divider d-md-block d-none"></div><div class="chart-box flex-grow-1 ms-md-3"><div class="card border-0 h-100 rounded-4 shadow-sm"><div class="card-body pb-2 pt-4 px-4"><h5 class=mb-3 style=font-weight:600;color:#1d1d1f>On Time vs Delayed Orders</h5><div class=chart-wrapper><canvas id=onTimeDelayedChart></canvas></div></div></div></div></div></div><div class="mb-4 container-fluid p-0"><div class=apple-card><div class=apple-card-header><h5 class=mb-0>Order List</h5></div><div class=apple-card-body><div class=apple-table-wrapper><table class=apple-table><thead class=sticky-top id=orderTableHead><tbody id=orderTableBody></table></div></div></div></div></div><div class="fade modal"id=updateOrderModal tabindex=-1 aria-hidden=true aria-labelledby=updateOrderModalLabel><div class="modal-dialog modal-xl custom-modal modal-dialog-centered"><div class="modal-content rounded-4 border-0 shadow-lg"><div class="modal-header border-0 pb-0"><h5 class=modal-title id=updateOrderModalLabel>Update Order <span id=modalOrderNumber class=text-primary></span></h5><button class=btn-close type=button data-bs-dismiss=modal aria-label=Close></button></div><div class="modal-body pt-0"><div class=table-responsive id=multiItemContainer><table class="table table-bordered table-hover"><thead class=table-light><tr><th>Product<th>Qty Ordered<th>Qty Delivered<th>Qty Cancelled<th>Unit Price<th>Delivery Date<th>Remarks<th>Status<th class=reasonHeader style=display:none>Reason<tbody id=multiItemTableBody></table></div></div><div class="border-0 modal-footer pt-0"><button class="btn btn-secondary px-4 rounded-pill"type=button data-bs-dismiss=modal>Cancel</button> <button class="btn btn-primary px-4 rounded-pill"type=button id=saveUpdateBtn>Save</button></div></div></div></div><div class="fade modal"id=customizeTableModal tabindex=-1 aria-hidden=true aria-labelledby=customizeTableModalLabel><div class="modal-dialog modal-dialog-scrollable"><div class=modal-content><div class=modal-header><h5 class=modal-title id=customizeTableModalLabel>Select Columns to Display</h5><button class=btn-close type=button data-bs-dismiss=modal aria-label=Close></button></div><div class=modal-body id=columnCheckboxContainer></div><div class=modal-footer><button class="btn btn-success"type=button id=confirmColumnsBtn>Apply</button> <button class="btn btn-secondary"type=button onclick=resetColumns()>Reset</button></div></div></div></div><div class="fade modal"id=reportModal tabindex=-1 aria-hidden=true aria-labelledby=reportModalLabel><div class=modal-dialog><div class="modal-content rounded-4 shadow"><div class=modal-header><h5 class=modal-title id=reportModalLabel>Select Supplier</h5><button class=btn-close type=button data-bs-dismiss=modal aria-label=Close></button></div><div class=modal-body><select id=supplierDropdown class="mb-3 form-select"><option value=""disabled selected>Select a supplier</select> <button class="btn btn-primary w-100"id=generateFollowUpReport>Generate Report</button></div></div></div></div><div class="fade modal"id=reportOutputModal tabindex=-1 aria-hidden=true aria-labelledby=reportOutputModalLabel><div class="modal-dialog modal-xl modal-dialog-scrollable"><div class="modal-content rounded-4 border-0 shadow-lg"><div class=modal-header><h5 class=modal-title>üìÑ Follow-Up Report for <span id=selectedSupplierName></span></h5><button class=btn-close type=button data-bs-dismiss=modal></button></div><div class=modal-body><div class="mb-3 d-flex justify-content-end"><button class="btn px-4 rounded-pill btn-outline-success"id=downloadFollowUpReport>‚¨áÔ∏è Download Report</button></div><div class=table-responsive><table class="table apple-style-report-table"id=followUpReportTable><thead><tr><th><div class=resizable-header>Order Number</div><th><div class=resizable-header>Product</div><th><div class=resizable-header>Unit Price</div><th><div class=resizable-header>Qty Ordered</div><th><div class=resizable-header>Amount</div><th><div class=resizable-header>Qty Delivered</div><th><div class=resizable-header>Qty Cancelled</div><th><div class=resizable-header>Balance</div><th><div class=resizable-header>Need By Date</div><th><div class=resizable-header>Remarks</div><tbody id=reportTableBody></table></div></div></div></div></div><div class="fade modal"id=dateRangeModal tabindex=-1 aria-hidden=true aria-labelledby=dateRangeModalLabel><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title id=dateRangeModalLabel>Select Date Range</h5><button class=btn-close type=button data-bs-dismiss=modal aria-label=Close></button></div><div class=modal-body><label for=startMonth>Start Month:</label> <input id=startMonth class="mb-2 form-control"type=month> <label for=endMonth>End Month:</label> <input id=endMonth class="mb-2 form-control"type=month></div><div class=modal-footer><button class="btn btn-secondary"type=button data-bs-dismiss=modal>Cancel</button> <button class="btn btn-primary"id=confirmDateRangeBtn>Generate Report</button></div></div></div></div><div class="fade modal"id=rrUploadModal tabindex=-1><div class=modal-dialog><div class="modal-content p-3"><div class=modal-header><h5 class=modal-title>üìÑ Upload RR Excel File</h5><button class=btn-close type=button data-bs-dismiss=modal></button></div><div class=modal-body><input id=rrUploadInput class=form-control type=file accept=".xlsx, .xls"></div></div></div></div><div class="fade modal"id=rrReportModal tabindex=-1><div class="modal-dialog modal-xl"><div class="modal-content p-3"><div class=modal-header><h5 class=modal-title>üì¶ Receipt Report</h5><button class=btn-close type=button data-bs-dismiss=modal></button></div><div class=modal-body><div class="mb-2 d-flex gap-2 justify-content-between"><input id=searchPackingSlipInput class="form-control form-control-sm w-50"placeholder="üîç Search Packing Slip..."><div class=mb-3><button class="btn btn-secondary btn-sm"data-bs-target=#assignCurrencyModal data-bs-toggle=modal>üí± Assign Supplier Currency</button></div><div class=mt-4 id=rrFilteredSupplierTablesContainer></div><div class="d-flex gap-2"><button class="btn btn-sm btn-success"id=downloadRRReport>‚¨á Download as Excel</button> <button class="btn btn-sm btn-danger"id=clearRRReport>üóë Clear Data</button></div></div><table class="table table-bordered table-striped"><thead class=table-light id=rrReportTableHeadRow><tr><th class="text-center bg-secondary fs-6 text-white"colspan=5>TRANSMITTAL OF INVOICE WITH RECEIVING REPORT CPS<tr><th>Receipt<th>Date<th>Supplier<th>Packing Slip<th>Receiver<tbody id=rrReportTableBody></table></div></div></div></div><div class="fade modal"id=rowDetailModal tabindex=-1><div class=modal-dialog><div class="modal-content p-3"><div class=modal-header><h5 class=modal-title>üìã Edit Row Details</h5><button class=btn-close type=button data-bs-dismiss=modal></button></div><div class=modal-body><form id=rowDetailForm><div class=mb-2><label class=form-label>Department</label> <input id=detailDepartment class=form-control required></div><div class=mb-2><label class=form-label>P.O #</label> <input id=detailPO class=form-control required></div><div class=mb-2><label class=form-label>P.R #</label> <input id=detailPR class=form-control required></div><div class=mb-2><label class=form-label>Amount</label> <input id=detailAmount class=form-control required min=0 step=0.01 type=number></div><div class=text-end><button class="btn btn-primary"type=submit>üíæ Save</button></div></form></div></div></div></div><div class="fade modal"id=customizeChartModal tabindex=-1><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Customize Chart Types</h5><button class=btn-close type=button data-bs-dismiss=modal></button></div><div class=modal-body><label class=form-label for=chart1Type>Chart 1 (Sales)</label> <select id=chart1Type class="mb-3 form-select"><option value=line>üìà Line<option value=bar>üìä Bar<option value=area>üåä Area</select> <label class=form-label for=chart2Type>Chart 2 (Orders)</label> <select id=chart2Type class="mb-3 form-select"><option value=bar>üì¶ Bar<option value=line>üìà Line<option value=area>üåä Area</select></div><div class=modal-footer><button class="btn btn-primary"id=confirmChartChoices>Apply</button></div></div></div></div><div class="fade modal"id=assignCurrencyModal tabindex=-1><div class=modal-dialog><div class="modal-content p-3"><div class=modal-header><h5 class=modal-title>üí± Assign Supplier Currency</h5><button class=btn-close type=button data-bs-dismiss=modal></button></div><div class=modal-body><div id=assignCurrencyContainer></div></div><div class=modal-footer><button class="btn btn-primary"type=button id=applyCurrencyAssignments>Apply</button></div></div></div></div><div class="fade modal"id=deliveryPerformanceModal tabindex=-1 aria-hidden=true aria-labelledby=deliveryPerformanceModalLabel><div class="modal-dialog modal-xl modal-dialog-scrollable"><div class=modal-content><div class=modal-header><h5 class=modal-title id=deliveryPerformanceModalLabel>üì¶ Delivery Performance Report</h5><button class=btn-close type=button data-bs-dismiss=modal aria-label=Close></button></div><div class=modal-body><div class=table-responsive id=deliveryPerformanceContent></div></div></div></div></div><div class="fade modal"id=excelUploadLoaderModal tabindex=-1 aria-hidden=true><div class="modal-dialog modal-dialog-centered modal-lg"><div class="modal-content p-5 text-center"><h5 class=mb-4>Uploading Excel File</h5><div class=progress style=height:30px><div class="fs-6 progress-bar progress-bar-animated progress-bar-striped"id=excelUploadProgressBar style=width:0% role=progressbar>0%</div></div></div></div></div><footer class=apple-footer><div class=footer-container><div class=footer-section><p class=footer-title>Order Monitoring<p class=footer-subtext>Built for performance and simplicity.</div><div class=footer-links><a href=info-sections.html>Privacy</a> <a href=info-sections.html>Terms</a> <a href=info-sections.html>Support</a> <a href=info-sections.html>About</a></div><div class=footer-copy>¬© <span id=currentYear></span> TrackWise. All rights reserved. | by Jefferson Molina</div></div></footer>
</body>
<script src=https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js></script><script src=https://cdn.jsdelivr.net/npm/chart.js></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js></script><script src=https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0></script><script src=https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js></script><script src=https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js></script><script src=https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js></script><script src=https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics-compat.js></script>
<script>
const _0x241251=_0x5ed1;(function(_0xa541b7,_0x4a2782){const _0x3836d8=_0x5ed1,_0x18f9f0=_0xa541b7();while(!![]){try{const _0x4c9138=parseInt(_0x3836d8(0x2af))/0x1*(-parseInt(_0x3836d8(0x22d))/0x2)+-parseInt(_0x3836d8(0x300))/0x3+-parseInt(_0x3836d8(0x1fa))/0x4+-parseInt(_0x3836d8(0x1e2))/0x5+parseInt(_0x3836d8(0x293))/0x6*(parseInt(_0x3836d8(0x1b1))/0x7)+parseInt(_0x3836d8(0x337))/0x8+parseInt(_0x3836d8(0x326))/0x9;if(_0x4c9138===_0x4a2782)break;else _0x18f9f0['push'](_0x18f9f0['shift']());}catch(_0x489d0c){_0x18f9f0['push'](_0x18f9f0['shift']());}}}(_0x4963,0x9b3a4));const firebaseConfig={'apiKey':'AIzaSyD9LCzMuEGIiRQrOVCgH6d-jxxJLZ0QBCk','authDomain':'order-monitoring-purchasing.firebaseapp.com','projectId':'order-monitoring-purchasing','storageBucket':_0x241251(0x2aa),'messagingSenderId':_0x241251(0x25c),'appId':_0x241251(0x1bc),'measurementId':_0x241251(0x38a)};firebase['initializeApp'](firebaseConfig),firebase[_0x241251(0x308)]();const auth=firebase[_0x241251(0x1cb)](),firestore=firebase[_0x241251(0x336)](),btnCustomizeTable=document['getElementById'](_0x241251(0x323)),customizeTableModal=new bootstrap[(_0x241251(0x25d))](document['getElementById'](_0x241251(0x2b4))),columnCheckboxContainer=document[_0x241251(0x1d8)]('columnCheckboxContainer'),confirmColumnsBtn=document[_0x241251(0x1d8)](_0x241251(0x361)),updateNavLink=document['getElementById'](_0x241251(0x244));firebase[_0x241251(0x1cb)]()[_0x241251(0x374)](async _0x4f1371=>{const _0x5219f0=_0x241251;if(!_0x4f1371){window[_0x5219f0(0x2d8)][_0x5219f0(0x311)]=_0x5219f0(0x1b9);return;}const _0x5eb5bd=firebase[_0x5219f0(0x336)]()[_0x5219f0(0x22a)]('users')[_0x5219f0(0x208)](_0x4f1371['uid']),_0x213a4c=await _0x5eb5bd[_0x5219f0(0x2ea)](),_0x533cc3=_0x213a4c[_0x5219f0(0x310)](),_0x24c45c=localStorage['getItem']('sessionId');!_0x533cc3[_0x5219f0(0x368)]||_0x533cc3[_0x5219f0(0x368)]!==_0x24c45c?(alert(_0x5219f0(0x19b)),await firebase[_0x5219f0(0x1cb)]()['signOut'](),localStorage[_0x5219f0(0x1d3)](_0x5219f0(0x368)),window[_0x5219f0(0x2d8)][_0x5219f0(0x311)]=_0x5219f0(0x241)):currentUserId=_0x4f1371[_0x5219f0(0x384)];});let inactivityTimer,fullData=[],currentEditingOrderId='',currentUserId=null,chartInstance=null,selectedColumns=[],draggedColumnIndex=null,ordersChartInstance=null,fullColumnOrder=[],chart1Type=localStorage[_0x241251(0x2b5)](_0x241251(0x27b))||_0x241251(0x1a4),chart2Type=localStorage[_0x241251(0x2b5)](_0x241251(0x325))||_0x241251(0x31d),globalRRData=[],currentSearch='',currentStatus=_0x241251(0x1c2),currentMonthSort='',lastUpdatedOrderNumber=null,selectedOrderId=null,onTimeDelayedChartInstance;document[_0x241251(0x1d8)](_0x241251(0x2f9))[_0x241251(0x334)]=new Date()[_0x241251(0x252)]();const storedSelected=localStorage[_0x241251(0x2b5)]('selectedColumns');if(storedSelected)try{selectedColumns=JSON['parse'](storedSelected);}catch(_0x479a2b){selectedColumns=[];}selectedColumns[_0x241251(0x20e)]>0x0&&(fullColumnOrder=selectedColumns[_0x241251(0x26a)](fullColumnOrder['filter'](_0x49fc93=>!selectedColumns[_0x241251(0x2e6)](_0x49fc93))));btnCustomizeTable['addEventListener']('click',()=>{const _0x5bbd77=_0x241251;columnCheckboxContainer[_0x5bbd77(0x2df)]='';const _0x5c6485=fullColumnOrder['length']>0x0?fullColumnOrder:fullData[_0x5bbd77(0x20e)]>0x0?Object[_0x5bbd77(0x191)](fullData[0x0]):[];_0x5c6485[_0x5bbd77(0x37e)](_0x1032b5=>{const _0xeeafd2=_0x5bbd77,_0x1d08ab=selectedColumns['includes'](_0x1032b5),_0x567476=document[_0xeeafd2(0x2de)](_0xeeafd2(0x1b5));_0x567476[_0xeeafd2(0x22f)]='form-check',_0x567476[_0xeeafd2(0x2df)]=_0xeeafd2(0x2c5)+_0x1032b5+_0xeeafd2(0x1ab)+_0x1032b5+'\x22\x20'+(_0x1d08ab?_0xeeafd2(0x278):'')+_0xeeafd2(0x25e)+_0x1032b5+'\x22>'+_0x1032b5+_0xeeafd2(0x35f),columnCheckboxContainer[_0xeeafd2(0x1a1)](_0x567476);}),customizeTableModal['show']();});const storedOrder=localStorage[_0x241251(0x2b5)]('fullColumnOrder');if(storedOrder)try{fullColumnOrder=JSON[_0x241251(0x32a)](storedOrder);}catch(_0x295f1d){fullColumnOrder=[];}confirmColumnsBtn[_0x241251(0x2e3)]('click',()=>{const _0x1245a0=_0x241251,_0x29430a=columnCheckboxContainer['querySelectorAll'](_0x1245a0(0x206)),_0x302a00=Array['from'](_0x29430a)[_0x1245a0(0x2c0)](_0x1831d1=>_0x1831d1[_0x1245a0(0x278)])['map'](_0x431eb6=>_0x431eb6[_0x1245a0(0x1e8)]);if(_0x302a00['length']===0x0){alert(_0x1245a0(0x202));return;}selectedColumns=fullColumnOrder[_0x1245a0(0x2c0)](_0x12c600=>_0x302a00[_0x1245a0(0x2e6)](_0x12c600)),localStorage[_0x1245a0(0x253)](_0x1245a0(0x2d5),JSON[_0x1245a0(0x34d)](selectedColumns)),localStorage[_0x1245a0(0x253)](_0x1245a0(0x2a4),JSON[_0x1245a0(0x34d)](fullColumnOrder)),customizeTableModal[_0x1245a0(0x31a)](),populateTable(fullData);});function resetColumns(){const _0x32d68a=_0x241251;selectedColumns=[],fullColumnOrder=[],localStorage[_0x32d68a(0x1d3)](_0x32d68a(0x2d5)),localStorage['removeItem'](_0x32d68a(0x2a4)),customizeTableModal[_0x32d68a(0x31a)](),populateTable(fullData);}document[_0x241251(0x2e3)](_0x241251(0x26f),()=>{const _0x193c0b=_0x241251,_0x587f8d=document[_0x193c0b(0x1d8)](_0x193c0b(0x244)),_0x507d9b=document[_0x193c0b(0x1d8)]('functionSidebar');_0x587f8d&&_0x507d9b&&_0x587f8d['addEventListener']('click',_0x3f0e8f=>{const _0x4b4b5a=_0x193c0b;_0x3f0e8f[_0x4b4b5a(0x1fe)](),_0x507d9b['classList']['toggle']('translate-x-0'),_0x507d9b[_0x4b4b5a(0x28a)][_0x4b4b5a(0x309)](_0x4b4b5a(0x2bb)),_0x507d9b['classList']['toggle'](_0x4b4b5a(0x1e7));});}),document[_0x241251(0x1d8)](_0x241251(0x244))[_0x241251(0x2e3)](_0x241251(0x2ce),()=>{const _0x34c5aa=_0x241251,_0x283f7d=document['getElementById'](_0x34c5aa(0x223)),_0x3e24cf=document[_0x34c5aa(0x1d8)](_0x34c5aa(0x219));_0x283f7d[_0x34c5aa(0x28a)][_0x34c5aa(0x309)](_0x34c5aa(0x1f5)),_0x3e24cf[_0x34c5aa(0x28a)][_0x34c5aa(0x309)](_0x34c5aa(0x220));}),auth[_0x241251(0x374)](async _0x441e67=>{const _0x14204b=_0x241251;if(!_0x441e67){window[_0x14204b(0x2d8)]['href']='Loginindex.html';return;}try{const _0x270280=firestore[_0x14204b(0x22a)](_0x14204b(0x237))['doc'](_0x441e67[_0x14204b(0x384)]),_0x2be77d=await _0x270280[_0x14204b(0x2ea)](),_0x722770=_0x2be77d[_0x14204b(0x310)](),_0x343d21=localStorage[_0x14204b(0x2b5)]('sessionId');if(!_0x722770[_0x14204b(0x368)]||_0x722770[_0x14204b(0x368)]!==_0x343d21){alert('üö´\x20You‚Äôve\x20been\x20logged\x20out\x20because\x20another\x20login\x20occurred.'),await auth['signOut'](),localStorage[_0x14204b(0x1d3)](_0x14204b(0x368)),window[_0x14204b(0x2d8)][_0x14204b(0x311)]=_0x14204b(0x1b9);return;}if(!_0x722770[_0x14204b(0x37c)]||_0x722770[_0x14204b(0x37c)]!==_0x14204b(0x33f)){alert(_0x14204b(0x291)),await auth[_0x14204b(0x1a5)](),window[_0x14204b(0x2d8)][_0x14204b(0x311)]=_0x14204b(0x1b9);return;}currentUserId=_0x441e67[_0x14204b(0x384)];const _0x3b7713=document[_0x14204b(0x1d8)](_0x14204b(0x2a5));_0x3b7713&&(_0x3b7713[_0x14204b(0x334)]=_0x722770?.['fullName']||_0x441e67[_0x14204b(0x22c)]),loadOrdersFromFirestore(currentUserId);}catch(_0x4fce17){console[_0x14204b(0x332)](_0x14204b(0x1b7),_0x4fce17),await auth[_0x14204b(0x1a5)](),localStorage[_0x14204b(0x1d3)](_0x14204b(0x368)),window['location'][_0x14204b(0x311)]=_0x14204b(0x1b9);}}),document[_0x241251(0x1d8)](_0x241251(0x21e))[_0x241251(0x2e3)](_0x241251(0x217),handleFile,![]),document[_0x241251(0x1d8)](_0x241251(0x1a2))[_0x241251(0x2e3)]('input',filterTable),document[_0x241251(0x1d8)](_0x241251(0x1b6))[_0x241251(0x2e3)]('change',filterTable),document[_0x241251(0x1d8)](_0x241251(0x270))[_0x241251(0x2e3)](_0x241251(0x217),filterTable);async function loadOrdersFromFirestore(_0x36a271){const _0x1b1104=_0x241251;try{const _0x5f963c=await firestore['collection'](_0x1b1104(0x247))[_0x1b1104(0x208)](_0x36a271)['collection'](_0x1b1104(0x1c1))['get']();fullData=[],_0x5f963c[_0x1b1104(0x37e)](_0x259313=>{const _0x59e933=_0x1b1104,_0x464580=_0x259313[_0x59e933(0x310)]();_0x464580['docId']=_0x259313['id'],fullData[_0x59e933(0x1aa)](_0x464580);}),populateTable(fullData),updateSummary(fullData),renderCharts(fullData);}catch(_0x3288df){console[_0x1b1104(0x332)](_0x1b1104(0x1de),_0x3288df),fullData=[],populateTable(fullData),updateSummary(fullData);}}function handleFile(_0x5ca55c){const _0x725589=_0x241251,_0x55f487=_0x5ca55c[_0x725589(0x214)][_0x725589(0x211)][0x0];if(!_0x55f487||!currentUserId)return;showExcelUploadModal(),updateExcelUploadProgress(0x5);const _0x303293=new FileReader();_0x303293[_0x725589(0x36d)]=async function(_0x3ea5c3){const _0x48f425=_0x725589;try{updateExcelUploadProgress(0xf);const _0x10c33c=new Uint8Array(_0x3ea5c3[_0x48f425(0x214)]['result']),_0xdeab4=XLSX[_0x48f425(0x354)](_0x10c33c,{'type':_0x48f425(0x287)}),_0x21cdea=_0xdeab4[_0x48f425(0x2f7)][_0xdeab4['SheetNames'][0x0]];updateExcelUploadProgress(0x1e),fullData=XLSX[_0x48f425(0x315)][_0x48f425(0x290)](_0x21cdea),console['log'](_0x48f425(0x280),fullData);if(fullData[_0x48f425(0x20e)]>0x0)fullColumnOrder=Object['keys'](fullData[0x0]),selectedColumns=[...fullColumnOrder],localStorage[_0x48f425(0x253)](_0x48f425(0x2a4),JSON[_0x48f425(0x34d)](fullColumnOrder)),localStorage[_0x48f425(0x253)](_0x48f425(0x2d5),JSON[_0x48f425(0x34d)](selectedColumns));else{hideExcelUploadModal(),alert('‚ùå\x20Excel\x20is\x20empty\x20or\x20has\x20no\x20valid\x20header\x20row.');return;}const _0x5e46f8=[_0x48f425(0x35e),_0x48f425(0x363),'Tentative\x20Delivery\x20Date'];_0x5e46f8[_0x48f425(0x37e)](_0x107f5f=>{const _0x4ad3ed=_0x48f425;if(!fullColumnOrder[_0x4ad3ed(0x2e6)](_0x107f5f))fullColumnOrder['push'](_0x107f5f);if(!selectedColumns[_0x4ad3ed(0x2e6)](_0x107f5f))selectedColumns[_0x4ad3ed(0x1aa)](_0x107f5f);}),localStorage[_0x48f425(0x253)](_0x48f425(0x2a4),JSON[_0x48f425(0x34d)](fullColumnOrder)),localStorage[_0x48f425(0x253)](_0x48f425(0x2d5),JSON['stringify'](selectedColumns)),updateExcelUploadProgress(0x32);const _0x22b9b6=[_0x48f425(0x321),'Need\x20By\x20Date','Approved\x20Date',_0x48f425(0x2b7),_0x48f425(0x35e),'Tentative\x20Delivery\x20Date'];fullData=fullData[_0x48f425(0x2ed)](_0x48268b=>{const _0x27556b=_0x48f425;return _0x22b9b6[_0x27556b(0x37e)](_0x104905=>{if(_0x48268b[_0x104905])_0x48268b[_0x104905]=formatDate(_0x48268b[_0x104905]);}),_0x48268b;}),updateExcelUploadProgress(0x46),await saveOrdersToFirestore(currentUserId,fullData),updateExcelUploadProgress(0x5a),await loadOrdersFromFirestore(currentUserId),updateExcelUploadProgress(0x64),setTimeout(()=>{const _0x57a78f=_0x48f425;hideExcelUploadModal(),alert(_0x57a78f(0x288));},0x190);}catch(_0x45acc0){console[_0x48f425(0x332)](_0x48f425(0x2ef),_0x45acc0),hideExcelUploadModal(),alert(_0x48f425(0x263));}},_0x303293[_0x725589(0x2ee)](_0x55f487);}function updateRowDisplay(_0x2b2683,_0x58ac54){const _0x452674=_0x241251,_0x503c01=document[_0x452674(0x1d8)](_0x452674(0x199)),_0x59b496=_0x503c01?.[_0x452674(0x347)][_0x2b2683];if(!_0x59b496)return;const _0x280364=_0x59b496['querySelector']('[data-field=\x22Tentative\x20Delivery\x20Date\x22]');_0x280364&&(_0x280364[_0x452674(0x334)]=formatDateDisplay(_0x58ac54[_0x452674(0x345)]));const _0x1407e4=_0x59b496[_0x452674(0x1e1)]('[data-field=\x22Status\x22]');_0x1407e4&&(_0x1407e4[_0x452674(0x334)]=_0x58ac54[_0x452674(0x2c4)]);const _0x570db7=_0x59b496[_0x452674(0x1e1)](_0x452674(0x1c8));_0x570db7&&(_0x570db7[_0x452674(0x334)]=_0x58ac54['Reason']||'');}const btnShowUpdate=document[_0x241251(0x1d8)](_0x241251(0x271)),updateOrderModal=new bootstrap[(_0x241251(0x25d))](document[_0x241251(0x1d8)]('updateOrderModal')),modalOrderNumber=document['getElementById'](_0x241251(0x2fe)),saveUpdateBtn=document[_0x241251(0x1d8)](_0x241251(0x352));function computeStatus(_0x587162){const _0x39091a=_0x241251,_0x3a49b8=Number(_0x587162[_0x39091a(0x19c)])||0x0,_0x1d4fc0=_0x587162[_0x39091a(0x35e)]?new Date(_0x587162[_0x39091a(0x35e)]):null,_0x586292=_0x587162[_0x39091a(0x345)]?new Date(_0x587162[_0x39091a(0x345)]):null;if(_0x3a49b8>0x0)return _0x39091a(0x1ff);if(_0x1d4fc0&&_0x586292)return _0x1d4fc0>_0x586292?_0x39091a(0x264):_0x39091a(0x20b);return'Pending';}async function populateTable(_0x2e9863){const _0x7265a1=_0x241251;console[_0x7265a1(0x355)](_0x7265a1(0x2b9),_0x2e9863);const _0x25234b=document[_0x7265a1(0x1d8)](_0x7265a1(0x367)),_0x227c39=document[_0x7265a1(0x1d8)](_0x7265a1(0x375));if(!_0x25234b||!_0x227c39){console[_0x7265a1(0x332)](_0x7265a1(0x19d));return;}_0x25234b[_0x7265a1(0x2df)]='',_0x227c39[_0x7265a1(0x2df)]='';if(!Array[_0x7265a1(0x254)](_0x2e9863)||_0x2e9863['length']===0x0){const _0x5f9498=document['createElement']('tr'),_0x730312=document[_0x7265a1(0x2de)]('td');_0x730312['colSpan']=selectedColumns[_0x7265a1(0x20e)]||0x1,_0x730312['className']='text-center\x20py-3\x20text-muted',_0x730312[_0x7265a1(0x334)]=_0x7265a1(0x201),_0x5f9498[_0x7265a1(0x1a1)](_0x730312),_0x25234b[_0x7265a1(0x1a1)](_0x5f9498);return;}if(!Array[_0x7265a1(0x254)](selectedColumns)||selectedColumns[_0x7265a1(0x20e)]===0x0){const _0x5cbce2=localStorage[_0x7265a1(0x2b5)](_0x7265a1(0x2d5));if(_0x5cbce2)try{selectedColumns=JSON[_0x7265a1(0x32a)](_0x5cbce2)['filter'](_0x3213d9=>Object[_0x7265a1(0x191)](_0x2e9863[0x0])['includes'](_0x3213d9));}catch{selectedColumns=Object[_0x7265a1(0x191)](_0x2e9863[0x0]);}else selectedColumns=Object[_0x7265a1(0x191)](_0x2e9863[0x0]);}if(!selectedColumns[_0x7265a1(0x2e6)](_0x7265a1(0x2c4)))selectedColumns[_0x7265a1(0x1aa)](_0x7265a1(0x2c4));if(!selectedColumns['includes'](_0x7265a1(0x2ac)))selectedColumns[_0x7265a1(0x1aa)]('Reason');const _0xaa0e2c=selectedColumns,_0x500bd=document[_0x7265a1(0x2de)]('tr');_0xaa0e2c[_0x7265a1(0x37e)](_0x485bb9=>{const _0x26d98b=_0x7265a1,_0x498722=document[_0x26d98b(0x2de)]('th');_0x498722[_0x26d98b(0x334)]=_0x485bb9,_0x498722[_0x26d98b(0x31f)]('draggable',!![]),_0x498722[_0x26d98b(0x281)][_0x26d98b(0x226)]=_0x485bb9;const _0x43f6f7=document[_0x26d98b(0x2de)]('div');_0x43f6f7[_0x26d98b(0x28a)]['add'](_0x26d98b(0x1ae)),_0x498722[_0x26d98b(0x1a1)](_0x43f6f7);if(typeof enableResize===_0x26d98b(0x2c1))enableResize(_0x498722,_0x43f6f7);_0x498722[_0x26d98b(0x2e3)](_0x26d98b(0x239),handleDragStart),_0x498722[_0x26d98b(0x2e3)](_0x26d98b(0x2ae),handleDragOver),_0x498722[_0x26d98b(0x2e3)](_0x26d98b(0x274),handleDrop),_0x500bd['appendChild'](_0x498722);}),_0x227c39['appendChild'](_0x500bd);for(const _0x4994e0 of _0x2e9863){const _0x36071a=document[_0x7265a1(0x2de)]('tr');if(_0x4994e0[_0x7265a1(0x277)])_0x36071a[_0x7265a1(0x31f)](_0x7265a1(0x2ba),_0x4994e0['docId']);if(_0x4994e0[_0x7265a1(0x257)])_0x36071a['setAttribute'](_0x7265a1(0x233),_0x4994e0[_0x7265a1(0x257)]);let _0x1cd841=_0x7265a1(0x29c);const _0x20e1c3=Number(_0x4994e0[_0x7265a1(0x1bf)])||0x0,_0x40002f=Number(_0x4994e0['Quantity\x20Delivered'])||0x0,_0x4fa118=Number(_0x4994e0[_0x7265a1(0x19c)])||0x0,_0x30dc82=_0x4994e0[_0x7265a1(0x35e)]?new Date(_0x4994e0[_0x7265a1(0x35e)]):null,_0x223df2=_0x4994e0['Tentative\x20Delivery\x20Date']?new Date(_0x4994e0[_0x7265a1(0x345)]):null;if(_0x4fa118>0x0)_0x1cd841=_0x7265a1(0x1ff);else{if(_0x4994e0['Number']){const _0x26baca=_0x2e9863[_0x7265a1(0x2c0)](_0x2b4ad1=>_0x2b4ad1[_0x7265a1(0x257)]===_0x4994e0[_0x7265a1(0x257)])[_0x7265a1(0x33b)]((_0x27b8e2,_0x331546)=>_0x27b8e2+(Number(_0x331546[_0x7265a1(0x1bf)])||0x0),0x0),_0x5574f3=_0x2e9863[_0x7265a1(0x2c0)](_0x1255ee=>_0x1255ee[_0x7265a1(0x257)]===_0x4994e0[_0x7265a1(0x257)])[_0x7265a1(0x33b)]((_0x329390,_0x2994cb)=>_0x329390+(Number(_0x2994cb[_0x7265a1(0x21f)])||0x0),0x0);if(_0x5574f3>0x0&&_0x5574f3<_0x26baca)_0x1cd841=_0x7265a1(0x33a);else{if(_0x40002f===_0x20e1c3&&_0x30dc82&&_0x223df2)_0x1cd841=_0x30dc82>_0x223df2?_0x7265a1(0x264):_0x7265a1(0x20b);else{if(_0x40002f===_0x20e1c3&&!_0x30dc82)_0x1cd841=_0x7265a1(0x29c);else _0x40002f===0x0?_0x1cd841=_0x7265a1(0x29c):_0x1cd841=_0x7265a1(0x20b);}}}}const _0x5b532b=[_0x7265a1(0x264),'Cancelled'][_0x7265a1(0x2e6)](_0x1cd841);if((_0x1cd841!==_0x4994e0[_0x7265a1(0x2c4)]||_0x5b532b&&_0x4994e0['Reason']!==_0x4994e0[_0x7265a1(0x2ac)])&&_0x4994e0[_0x7265a1(0x277)]&&currentUserId){const _0x1813a9={'Status':_0x1cd841};_0x5b532b&&_0x4994e0['Reason']&&(_0x1813a9[_0x7265a1(0x2ac)]=_0x4994e0[_0x7265a1(0x2ac)]);try{await firestore[_0x7265a1(0x22a)](_0x7265a1(0x247))[_0x7265a1(0x208)](currentUserId)[_0x7265a1(0x22a)]('userOrders')['doc'](_0x4994e0['docId'])[_0x7265a1(0x20f)](_0x1813a9),console[_0x7265a1(0x355)](_0x7265a1(0x299)+_0x4994e0['docId']+':',_0x1813a9);}catch(_0x1f1324){console[_0x7265a1(0x332)](_0x7265a1(0x23c)+_0x4994e0[_0x7265a1(0x277)]+':',_0x1f1324);}}for(const _0x210d76 of _0xaa0e2c){const _0xf922ec=document['createElement']('td');let _0x2d2ba3=_0x4994e0[_0x210d76]??_0x4994e0[_0x210d76[_0x7265a1(0x2c9)]()]??'';if(_0x210d76==='Status'){_0xf922ec['textContent']=_0x1cd841,_0xf922ec[_0x7265a1(0x28a)][_0x7265a1(0x348)](_0x7265a1(0x283)),_0x36071a[_0x7265a1(0x1a1)](_0xf922ec);continue;}if(_0x210d76===_0x7265a1(0x2ac)){_0xf922ec[_0x7265a1(0x28a)][_0x7265a1(0x348)](_0x7265a1(0x261));if(_0x5b532b){const _0x10f285=document['createElement'](_0x7265a1(0x28c));_0x10f285[_0x7265a1(0x22f)]=_0x7265a1(0x2a3),_0x10f285[_0x7265a1(0x281)][_0x7265a1(0x386)]=_0x7265a1(0x2ac);const _0xe47bf0=['',_0x7265a1(0x1a0),'Price\x20Update',_0x7265a1(0x27f),_0x7265a1(0x2d9),_0x7265a1(0x2d6),_0x7265a1(0x268)];_0xe47bf0[_0x7265a1(0x37e)](_0x97c3d5=>{const _0x8dae30=_0x7265a1,_0x2539fa=document[_0x8dae30(0x2de)](_0x8dae30(0x2f5));_0x2539fa[_0x8dae30(0x1e8)]=_0x97c3d5,_0x2539fa[_0x8dae30(0x334)]=_0x97c3d5||'Select\x20reason';if(_0x97c3d5===_0x4994e0[_0x8dae30(0x2ac)])_0x2539fa[_0x8dae30(0x29b)]=!![];_0x10f285[_0x8dae30(0x1a1)](_0x2539fa);}),_0x10f285[_0x7265a1(0x2e3)](_0x7265a1(0x217),async()=>{const _0x1ff760=_0x7265a1,_0x337702=_0x10f285[_0x1ff760(0x1e8)];_0x4994e0[_0x1ff760(0x2ac)]=_0x337702;try{await firestore[_0x1ff760(0x22a)](_0x1ff760(0x247))[_0x1ff760(0x208)](currentUserId)[_0x1ff760(0x22a)]('userOrders')[_0x1ff760(0x208)](_0x4994e0[_0x1ff760(0x277)])[_0x1ff760(0x20f)]({'Reason':_0x337702}),console[_0x1ff760(0x355)](_0x1ff760(0x2c6)+_0x4994e0[_0x1ff760(0x277)]+':',_0x337702);}catch(_0x2de801){console['error']('‚ùå\x20Failed\x20to\x20update\x20Reason\x20for\x20'+_0x4994e0[_0x1ff760(0x277)]+':',_0x2de801);}}),_0xf922ec['appendChild'](_0x10f285);}else _0xf922ec[_0x7265a1(0x334)]='‚Äî';_0x36071a[_0x7265a1(0x1a1)](_0xf922ec);continue;}if(_0x210d76[_0x7265a1(0x2c9)]()[_0x7265a1(0x2e6)](_0x7265a1(0x360)))_0xf922ec[_0x7265a1(0x28a)]['add'](_0x7265a1(0x2d7));if(_0x210d76[_0x7265a1(0x2c9)]()[_0x7265a1(0x2e6)](_0x7265a1(0x305)))_0xf922ec[_0x7265a1(0x28a)][_0x7265a1(0x348)](_0x7265a1(0x35c));if(_0x210d76['toLowerCase']()[_0x7265a1(0x2e6)]('cancelled'))_0xf922ec[_0x7265a1(0x28a)][_0x7265a1(0x348)](_0x7265a1(0x289));typeof _0x2d2ba3==='object'&&_0x2d2ba3!==null&&(_0x2d2ba3=JSON[_0x7265a1(0x34d)](_0x2d2ba3));(_0x210d76[_0x7265a1(0x2c9)]()[_0x7265a1(0x2e6)](_0x7265a1(0x284))||_0x210d76[_0x7265a1(0x2c9)]()[_0x7265a1(0x2e6)](_0x7265a1(0x1bd)))&&(_0x2d2ba3=Number(_0x2d2ba3||0x0)['toFixed'](0x2));if(_0x210d76===_0x7265a1(0x363)){const _0xb65338=document[_0x7265a1(0x2de)](_0x7265a1(0x28c));_0xb65338[_0x7265a1(0x22f)]=_0x7265a1(0x2a3);const _0x12fec1=['Selection',_0x7265a1(0x1b4),_0x7265a1(0x382),_0x7265a1(0x28d),'4-5\x20Weeks',_0x7265a1(0x262),'6-7\x20Weeks',_0x7265a1(0x37d),_0x7265a1(0x381),_0x7265a1(0x320),_0x7265a1(0x21c),'90-120\x20Days'];_0x12fec1[_0x7265a1(0x37e)](_0x5a85b3=>{const _0x4b641e=_0x7265a1,_0x4fda5e=document[_0x4b641e(0x2de)](_0x4b641e(0x2f5));_0x4fda5e[_0x4b641e(0x1e8)]=_0x5a85b3,_0x4fda5e[_0x4b641e(0x334)]=_0x5a85b3;if(_0x5a85b3===_0x2d2ba3)_0x4fda5e[_0x4b641e(0x29b)]=!![];_0xb65338[_0x4b641e(0x1a1)](_0x4fda5e);}),_0xb65338['addEventListener'](_0x7265a1(0x217),async()=>{const _0x3d58f2=_0x7265a1;_0x4994e0[_0x3d58f2(0x363)]=_0xb65338[_0x3d58f2(0x1e8)],_0x4994e0[_0x3d58f2(0x345)]=computeTentativeDate(_0x4994e0[_0x3d58f2(0x1ee)],_0xb65338['value']);try{await firestore['collection'](_0x3d58f2(0x247))[_0x3d58f2(0x208)](currentUserId)[_0x3d58f2(0x22a)](_0x3d58f2(0x1c1))[_0x3d58f2(0x208)](_0x4994e0[_0x3d58f2(0x277)])[_0x3d58f2(0x20f)]({'Lead\x20Time':_0x4994e0['Lead\x20Time'],'Tentative\x20Delivery\x20Date':_0x4994e0['Tentative\x20Delivery\x20Date']}),console[_0x3d58f2(0x355)](_0x3d58f2(0x302)+_0x4994e0[_0x3d58f2(0x277)]);}catch(_0x249cc1){console[_0x3d58f2(0x332)]('‚ùå\x20Failed\x20to\x20update\x20Lead\x20Time:',_0x249cc1),alert(_0x3d58f2(0x2e8));}setTimeout(()=>filterTable(),0x32);}),_0xf922ec[_0x7265a1(0x1a1)](_0xb65338);}else{if(_0x210d76===_0x7265a1(0x345))_0xf922ec[_0x7265a1(0x334)]=formatDateDisplay(_0x4994e0[_0x7265a1(0x345)]);else{if(_0x210d76[_0x7265a1(0x2c9)]()==='delivery\x20date')_0xf922ec[_0x7265a1(0x334)]=_0x4994e0[_0x7265a1(0x35e)]?formatDateDisplay(_0x4994e0[_0x7265a1(0x35e)]):'‚Äî';else _0x210d76['toLowerCase']()['includes'](_0x7265a1(0x20d))?_0xf922ec[_0x7265a1(0x334)]=formatDateDisplay(_0x2d2ba3):_0xf922ec['textContent']=_0x2d2ba3;}}_0x36071a['appendChild'](_0xf922ec);}_0x25234b[_0x7265a1(0x1a1)](_0x36071a);}console[_0x7265a1(0x355)]('‚úÖ\x20Table\x20populated\x20with',_0x2e9863['length'],_0x7265a1(0x1df));}function handleDragStart(_0x7802ef){const _0x14e037=_0x241251;draggedColumnName=_0x7802ef[_0x14e037(0x214)]['dataset'][_0x14e037(0x226)],_0x7802ef[_0x14e037(0x32b)][_0x14e037(0x351)]='move';}function handleDragOver(_0xbddade){const _0xba6bbd=_0x241251;_0xbddade['preventDefault'](),_0xbddade[_0xba6bbd(0x32b)][_0xba6bbd(0x376)]=_0xba6bbd(0x1dd);}function _0x4963(){const _0x506d31=['stopPropagation','area','auth','data-supplier','ordersIssuedChart','User\x20not\x20authenticated','selectedSupplierName','find','Failed\x20to\x20save\x20RR\x20report\x20data:','zIndex','removeItem','rrReportTableBody','set','th,\x20td','totalOrders','getElementById','RR_Report_','Total','#multiItemTableBody\x20input,\x20#multiItemTableBody\x20select','updateQtyOrdered','move','Error\x20loading\x20user\x20orders:','rows.','.xlsx','querySelector','10150YsimzX','input','BALANCE','Please\x20select\x20both\x20start\x20and\x20end\x20month.','status','hidden','value','\x0a\x20\x20<td>','name','bg-warning\x20text-dark','rrUploadModal','btnDownloadExcel','Approved\x20Date','Delivered','end','from','warn','%\x22></div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20<small\x20class=\x22text-muted\x22>On\x20Time\x20Percentage</small>\x0a\x20\x20\x20\x20','select[data-field=\x22Reason\x22][data-index=\x22','active','numeric','\x20orders\x20updated.','size','\x0a\x20\x20\x20\x20\x20\x20<thead\x20class=\x22table-light\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Order\x20#</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Description</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Order\x20Date</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Tentative\x20Delivery\x20Date</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Delivery\x20Date</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Status</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20\x20\x20<tbody>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','3169236eMENmR','status-pending','logoutBtn','rgba(0,122,255,0.2)','preventDefault','Cancelled','updateQtyDelivered','üîç\x20No\x20matching\x20records\x20found\x20for\x20your\x20filter.','Select\x20at\x20least\x20one\x20column\x20to\x20display.','remove','bg-danger','top','input[type=checkbox]','Unknown\x20Supplier','doc','USD','Percentage','On\x20Time','Department','date','length','update','detailAmount','files','description','</h6>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22d-flex\x20gap-3\x20flex-wrap\x20small\x20mb-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span><strong>On\x20Time:</strong>\x20<span\x20class=\x22text-success\x22>','target','show','order','change','parsed','mainContent','toFollowUpBtn','onTime','11-12\x20Weeks','UTC','excelFile','Quantity\x20Delivered','shifted','#orderTable\x20tbody\x20tr','FieldValue','functionSidebar','status-partial','closest','columnName','Date','‚ùå\x20Error:\x20For\x20\x22','.status','collection','‚ùå\x20Failed\x20to\x20update.\x20See\x20console\x20for\x20details.','email','4fOuVoF','writeFile','className','updateUnitPrice','RR\x20Report\x20updated.','Session\x20timestamp\x20update\x20failed\x20on\x20unload:','data-order-number','colspan','cancelled','follow_up_report.csv','users','partialOrders','dragstart','TRANSMITTAL\x20OF\x20INVOICE\x20WITH\x20RECEIVING\x20REPORT\x20CPS','Receipt','‚ùå\x20Firestore\x20update\x20failed\x20for\x20','getInstance','getTime','beforeunload','replace','login.html','has','[data-order-number=\x22','toggleSidebar','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20current\x20RR\x20Report\x20data\x20and\x20upload\x20new\x20data?','orders','removeEventListener','match','label','reportTableBody','index','delete','Download\x20error:','#ff3b30','\x22\x20data-field=\x22Description\x22\x20data-index=\x22','d-flex\x20align-items-center\x20gap-2','getFullYear','setItem','isArray','No\x20RR\x20Report\x20data\x20available\x20to\x20download.',')\x20exceeds\x20Ordered\x20(','Number','#007aff','Failed\x20to\x20download\x20RR\x20Report.','</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','An\x20error\x20occurred\x20while\x20clearing\x20the\x20RR\x20Report\x20data.','209378598320','Modal','>\x0a\x20\x20<label\x20class=\x22form-check-label\x22\x20for=\x22col-','json_to_sheet','key','reason-cell','5-6\x20Weeks','‚ùå\x20Failed\x20to\x20process\x20Excel\x20file.\x20Check\x20console\x20for\x20details.','Delayed','indexOf','Weeks','.rr-currency-select','Other','Ongoing','concat','Open','in\x20progress','OnTime',')\x20+\x20Cancelled\x20(','DOMContentLoaded','monthSort','btnShowUpdate','none','Error\x20updating\x20remarks:','drop','findIndex','cursor','docId','checked','clear','Error\x20saving\x20RR\x20report\x20to\x20Firestore:','chart1Type','\x22\x20/></td>\x0a\x20\x20\x20\x20\x20\x20<td><input\x20type=\x22number\x22\x20class=\x22form-control\x22\x20value=\x22','endMonth','transparent','Out\x20of\x20Stock','Excel\x20parsed\x20data:','dataset','bold','orderStatus','price','message','encode_cell','array','‚úÖ\x20Excel\x20file\x20uploaded\x20and\x20saved\x20successfully!','qtyCancelled','classList','detailPO','select','3-4\x20Weeks','confirmChartChoices','deliveryPerformanceModal','sheet_to_json','‚ùå\x20User\x20has\x20no\x20access\x20to\x20this\x20page.','#rrReportTableHeadRow\x20tr:nth-child(2)','6DtSDaO','%\x22\x20title=\x22On\x20Time\x20','updateRemarks','sort','keypress','currentUser','‚úÖ\x20Firestore\x20updated\x20for\x20','\x20Orders','selected','Pending','Monthly\x20Sales\x20(','searchPackingSlipInput','P.O\x20#','split','Product','chartCanvas','form-select\x20form-select-sm','fullColumnOrder','userEmailDisplay','center','000000','mousemove','<p\x20class=\x22text-muted\x22>No\x20matching\x20data\x20found\x20for\x20the\x20selected\x20range.</p>','order-monitoring-purchasing.appspot.com','getAttribute','Reason','book_new','dragover','593603VOlTgC','selected-row','download','bg-success','\x22\x20data-field=\x22Quantity\x20Cancelled\x22\x20data-index=\x22','customizeTableModal','getItem','downloadFollowUpReport','Order\x20Date\x20raw','table\x20table-bordered\x20table-sm\x20mb-4','üöÄ\x20Populating\x20table\x20with\x20data:','data-order-id','translate-x-full','\x22\x20data-field=\x22Remarks\x22\x20data-index=\x22','updateProduct','Remarks','‚úÖ\x20Updated\x20Order\x20','filter','function','Save','orderDate','Status','\x0a\x20\x20<input\x20class=\x22form-check-input\x22\x20type=\x22checkbox\x22\x20value=\x22','‚úÖ\x20Reason\x20updated\x20for\x20','me-2\x20mb-0\x20fw-semibold','submit','toLowerCase','entries','</td>\x0a\x20\x20<td>','No\x20Order\x20ID\x20entered.','bottom','click','rrReports','.column-resizer','‚ùå\x20Failed\x20to\x20update\x20order\x20','rgba(52,\x20199,\x2089,\x200.3)','ref','cancelledOrders','selectedColumns','Customer\x20Request','qtyOrdered','location','Logistics\x20Issue','translate-x-0','Days','serverTimestamp','getContext','createElement','innerHTML','<span\x20class=\x22badge\x20bg-dark\x20text-light\x22>Top\x203</span>','\x0a\x20\x20\x20\x20\x20\x20<h6\x20class=\x22mb-1\x20text-primary\x22>üì¶\x20','thin','addEventListener','book_append_sheet','P.R\x20#','includes','mouseup','Failed\x20to\x20update\x20Lead\x20Time.','</td>\x0a\x20\x20\x20\x20','get','form-select\x20form-select-sm\x20w-auto\x20rr-currency-select','status-inprogress','map','readAsArrayBuffer','Error\x20processing\x20Excel:','rrUploadInput','\x0a\x20\x20\x20\x20\x20\x20<td><input\x20type=\x22text\x22\x20class=\x22form-control\x22\x20value=\x22','reportModal','‚ö†Ô∏è\x20Missing\x20orderId\x20in\x20row','#34c759','option','tentativeDate','Sheets','short','currentYear','scroll','col-resize','partiallyDeliveredOrders','.qtyOrdered','modalOrderNumber','Currency','595224urQytR','Saving\x20to\x20Firestore:','‚úÖ\x20Lead\x20Time\x20updated\x20for\x20','‚ùå\x20Failed\x20to\x20save\x20currency\x20data:','toString','delivered','orderNumber','keydown','analytics','toggle','updateQtyCancelled','pageX','setHours','\x20to\x20','deliveredOrders','userSelect','data','href','<span\x20class=\x22badge\x20bg-secondary\x20text-light\x22>Top\x202</span>','generateFollowUpReport','\x22\x20/></td>\x0a\x20\x20\x20\x20\x20\x20<td><input\x20type=\x22date\x22\x20class=\x22form-control\x22\x20value=\x22','utils','Saving...','max','currencySelector','supplierDropdown','hide','detailPR','‚úÖ\x20Currency\x20assignment\x20saved\x20to\x20Firestore.','bar','partial','setAttribute','9-10\x20Weeks','Order\x20Date','Logout\x20error:','btnCustomizeTable','rrReportTableHeadRow','chart2Type','15305409UHuiBN','onTimeDelayedChartInstance','Amount','batch','parse','dataTransfer','‚ùå\x20Packing\x20Slip\x20not\x20found.','.qtyDelivered','width','detailDepartment','Unit\x20Price','status-delivered','error','join','textContent','clearRRReport','firestore','3102904fIzVfC','No\x20rows\x20available\x20to\x20export.','avgDelivery','Partially\x20Delivered','reduce','onTimePct','bg-secondary','toFixed','user','\x0a\x20\x20\x20\x20\x20\x20</tbody>\x0a\x20\x20\x20\x20','contains','Selection','getDate','mousedown','Tentative\x20Delivery\x20Date','Supplier','children','add','toLocaleString','statusReportBtn','cells','FilteredOrders','stringify','<option\x20value=\x22\x22\x20disabled\x20selected>Select\x20a\x20supplier</option>','trim','position','effectAllowed','saveUpdateBtn','long','read','log','startMonth','en-US','assignCurrencyContainer','allHeaders','confirmDateRangeBtn','RR\x20Report\x20saved\x20to\x20Firestore.','qtyDelivered','applyCurrencyAssignments','Delivery\x20Date','</label>\x0a','ordered','confirmColumnsBtn','table','Lead\x20Time','rows','N/A','then','orderTableBody','sessionId','PHP','table-success','aoa_to_sheet','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','onload','toISOString','deliveryDate','-01','Packing\x20Slip','exists','rrData','onAuthStateChanged','orderTableHead','dropEffect','rowDetailModal','[object\x20Date]','querySelectorAll','Description','catch','role','7-8\x20Weeks','forEach','btnCustomizeCharts','createObjectURL','8-9\x20Weeks','2-3\x20Weeks','‚ö†Ô∏è\x20User\x20not\x20authenticated.','uid','#rrReportTableBody\x20tr','field','.apple-style-report-table','You\x27ve\x20been\x20logged\x20out\x20due\x20to\x20inactivity.','destroy','G-PPNWT4ECV0','border','values','style','keys','test','dateRangeModal','No\x20order\x20loaded','</span></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span><strong>Delayed:</strong>\x20<span\x20class=\x22text-danger\x22>','delayed','\x20<span\x20class=\x22badge\x20bg-danger\x20text-light\x22>Bottom\x202</span>','reportOutputModal','ordersTableBody','!cols','üö´\x20You‚Äôve\x20been\x20logged\x20out\x20because\x20another\x20login\x20occurred.','Quantity\x20Cancelled','‚ùå\x20Table\x20elements\x20not\x20found.','commit','Delayed\x20(%)','Supplier\x20Delay','appendChild','searchInput','RR\x20Report\x20deleted\x20from\x20Firestore.','line','signOut','#333','rrReportModal','</td>\x0a','5px','push','\x22\x20id=\x22col-','rowDetailForm','Item\x20','resizer','downloadRRReport','\x22\x20/></td>\x0a\x20\x20\x20\x20\x20\x20<td><input\x20type=\x22text\x22\x20class=\x22form-control\x22\x20value=\x22','5091107VluRwF','height','toLocaleDateString','1-2\x20Weeks','div','statusFilter','Session\x20validation\x20error:','disabled','Loginindex.html','scrollIntoView','getDay','1:209378598320:web:0c143d69bc329a994d8a75','amount','slice','Quantity\x20Ordered','offsetWidth','userOrders','all','#rrReportTableHeadRow\x20tr:nth-child(2)\x20th','Receiver','Sidebar\x20or\x20toggleSidebar\x20not\x20found\x20in\x20the\x20DOM.','customizeChartModal','‚úÖ\x20Order\x20updated\x20successfully.','[data-field=\x22Reason\x22]'];_0x4963=function(){return _0x506d31;};return _0x4963();}function handleDrop(_0x40c9fb){const _0x2d2205=_0x241251;_0x40c9fb[_0x2d2205(0x1fe)]();const _0x19567b=_0x40c9fb[_0x2d2205(0x214)][_0x2d2205(0x225)]('th')?.[_0x2d2205(0x281)][_0x2d2205(0x226)];if(!draggedColumnName||!_0x19567b||draggedColumnName===_0x19567b)return;const _0x5d509e=selectedColumns[_0x2d2205(0x265)](draggedColumnName),_0x375d6a=selectedColumns['indexOf'](_0x19567b);if(_0x5d509e===-0x1||_0x375d6a===-0x1)return;const [_0x4bc19a]=selectedColumns['splice'](_0x5d509e,0x1);selectedColumns['splice'](_0x375d6a,0x0,_0x4bc19a),fullColumnOrder=Array[_0x2d2205(0x1f1)](new Set(selectedColumns[_0x2d2205(0x26a)](fullColumnOrder))),localStorage['setItem'](_0x2d2205(0x2d5),JSON['stringify'](selectedColumns)),localStorage[_0x2d2205(0x253)](_0x2d2205(0x2a4),JSON[_0x2d2205(0x34d)](fullColumnOrder)),populateTable(fullData),filterTable();}function enableResize(_0x29b16d,_0x3dc561){const _0x2aa0fc=_0x241251;let _0x1ac60c,_0x1191d7,_0xc099c3;_0x3dc561[_0x2aa0fc(0x2e3)](_0x2aa0fc(0x344),function(_0x54080){const _0x51f1d6=_0x2aa0fc;_0x1ac60c=_0x54080['pageX'],_0x1191d7=_0x29b16d[_0x51f1d6(0x1c0)],_0xc099c3=_0x29b16d['cellIndex'],document[_0x51f1d6(0x2e3)](_0x51f1d6(0x2a8),_0x57bfd4),document[_0x51f1d6(0x2e3)]('mouseup',_0x475584),_0x54080[_0x51f1d6(0x1fe)]();});function _0x57bfd4(_0x161fb9){const _0x36718e=_0x2aa0fc,_0x38b875=_0x1191d7+(_0x161fb9[_0x36718e(0x30b)]-_0x1ac60c);_0x29b16d[_0x36718e(0x190)][_0x36718e(0x32e)]=_0x38b875+'px';const _0x72c5d5=_0x29b16d[_0x36718e(0x225)](_0x36718e(0x362));if(_0x72c5d5)for(let _0x47db56 of _0x72c5d5[_0x36718e(0x364)]){_0x47db56[_0x36718e(0x34b)][_0xc099c3]&&(_0x47db56[_0x36718e(0x34b)][_0xc099c3]['style'][_0x36718e(0x32e)]=_0x38b875+'px');}}function _0x475584(){const _0x3a90c8=_0x2aa0fc;document[_0x3a90c8(0x248)](_0x3a90c8(0x2a8),_0x57bfd4),document['removeEventListener']('mouseup',_0x475584);}}const updateProduct=document['getElementById'](_0x241251(0x2bd)),updateQtyOrdered=document['getElementById'](_0x241251(0x1dc)),updateQtyDelivered=document[_0x241251(0x1d8)](_0x241251(0x200)),updateQtyCancelled=document[_0x241251(0x1d8)](_0x241251(0x30a)),updateUnitPrice=document[_0x241251(0x1d8)](_0x241251(0x230)),updateRemarks=document[_0x241251(0x1d8)](_0x241251(0x295));let currentOrderId=null,currentItem=null;btnShowUpdate[_0x241251(0x2e3)]('click',()=>{const _0x415564=_0x241251,_0x1badf7=prompt('Enter\x20Order\x20ID\x20to\x20update:');if(!_0x1badf7){alert(_0x415564(0x2cc));return;}const _0x1b845a=fullData[_0x415564(0x2c0)](_0x2654c3=>_0x2654c3[_0x415564(0x257)]&&_0x2654c3['Number'][_0x415564(0x304)]()===_0x1badf7);if(_0x1b845a['length']===0x0){alert('No\x20order\x20found\x20with\x20this\x20ID.');return;}currentOrderId=_0x1badf7,currentItem=[..._0x1b845a],modalOrderNumber[_0x415564(0x334)]=_0x1badf7;const _0x419fd3=document[_0x415564(0x1d8)]('multiItemTableBody');_0x419fd3[_0x415564(0x2df)]='';const _0x57a425=computeAggregatedStatus(_0x1b845a);_0x1b845a[_0x415564(0x37e)]((_0x208d51,_0x4f09a9)=>{const _0x547ce3=_0x415564,_0x8596ac=document[_0x547ce3(0x2de)]('tr');_0x8596ac[_0x547ce3(0x2df)]=_0x547ce3(0x2f1)+(_0x208d51[_0x547ce3(0x37a)]||'')+_0x547ce3(0x250)+_0x4f09a9+_0x547ce3(0x27c)+(_0x208d51['Quantity\x20Ordered']||0x0)+'\x22\x20data-field=\x22Quantity\x20Ordered\x22\x20data-index=\x22'+_0x4f09a9+_0x547ce3(0x27c)+(_0x208d51[_0x547ce3(0x21f)]||0x0)+'\x22\x20data-field=\x22Quantity\x20Delivered\x22\x20data-index=\x22'+_0x4f09a9+_0x547ce3(0x27c)+(_0x208d51['Quantity\x20Cancelled']||0x0)+_0x547ce3(0x2b3)+_0x4f09a9+_0x547ce3(0x27c)+(_0x208d51['Unit\x20Price']||0x0)+'\x22\x20step=\x220.01\x22\x20data-field=\x22Unit\x20Price\x22\x20data-index=\x22'+_0x4f09a9+_0x547ce3(0x314)+(_0x208d51[_0x547ce3(0x35e)]?formatDateForInput(_0x208d51[_0x547ce3(0x35e)]):'')+'\x22\x20data-field=\x22Delivery\x20Date\x22\x20data-index=\x22'+_0x4f09a9+_0x547ce3(0x1b0)+(_0x208d51[_0x547ce3(0x2be)]||'')+_0x547ce3(0x2bc)+_0x4f09a9+'\x22\x20/></td>\x0a\x20\x20\x20\x20\x20\x20<td\x20class=\x22status-cell\x22>'+_0x57a425+_0x547ce3(0x2e9),_0x419fd3['appendChild'](_0x8596ac);}),updateOrderModal[_0x415564(0x215)]();});function formatDateForInput(_0x59011f){const _0x1ab94a=_0x241251,_0x818a60=new Date(_0x59011f);if(isNaN(_0x818a60[_0x1ab94a(0x23e)]()))return'';return _0x818a60[_0x1ab94a(0x36e)]()[_0x1ab94a(0x2a0)]('T')[0x0];}function computeAggregatedStatus(_0x40081f){const _0x76d9d7=_0x241251,_0x32f6d5=_0x40081f['reduce']((_0x19a312,_0x22fc69)=>_0x19a312+(Number(_0x22fc69[_0x76d9d7(0x1bf)])||0x0),0x0),_0x528f58=_0x40081f[_0x76d9d7(0x33b)]((_0x30d5f3,_0x311648)=>_0x30d5f3+(Number(_0x311648[_0x76d9d7(0x21f)])||0x0),0x0),_0x4d4df2=_0x40081f[_0x76d9d7(0x33b)]((_0x5125b7,_0x20855c)=>_0x5125b7+(Number(_0x20855c[_0x76d9d7(0x19c)])||0x0),0x0);if(_0x4d4df2>0x0&&_0x528f58===0x0)return _0x76d9d7(0x1ff);if(_0x528f58>0x0&&_0x528f58<_0x32f6d5)return'Partially\x20Delivered';if(_0x528f58===_0x32f6d5&&_0x32f6d5>0x0){const _0x44ac84=_0x40081f[_0x76d9d7(0x2ed)](_0x337038=>_0x337038[_0x76d9d7(0x35e)])['filter'](Boolean)[_0x76d9d7(0x2ed)](_0xc8fe18=>new Date(_0xc8fe18)),_0x227bc8=_0x40081f[_0x76d9d7(0x2ed)](_0x13da4c=>_0x13da4c[_0x76d9d7(0x345)])[_0x76d9d7(0x2c0)](Boolean)[_0x76d9d7(0x2ed)](_0x158292=>new Date(_0x158292));if(_0x44ac84['length']>0x0&&_0x227bc8[_0x76d9d7(0x20e)]>0x0){const _0x23a90f=new Date(Math['min'](..._0x44ac84)),_0x1c3ddc=new Date(Math['min'](..._0x227bc8));return _0x23a90f>_0x1c3ddc?'Delayed':_0x76d9d7(0x20b);}return _0x76d9d7(0x29c);}if(_0x528f58===0x0&&_0x32f6d5>0x0)return _0x76d9d7(0x29c);return _0x76d9d7(0x29c);}saveUpdateBtn[_0x241251(0x2e3)]('click',async()=>{const _0x33f005=_0x241251;if(!currentUserId){alert(_0x33f005(0x1ce));return;}if(!currentOrderId||!currentItem||!Array[_0x33f005(0x254)](currentItem)){alert(_0x33f005(0x194));return;}const _0x465721=document['querySelectorAll'](_0x33f005(0x1db));let _0x4c3217=![];_0x465721[_0x33f005(0x37e)](_0x1efb79=>{const _0xbb799d=_0x33f005,_0x50dd98=parseInt(_0x1efb79[_0xbb799d(0x281)][_0xbb799d(0x24c)]),_0x23df8b=_0x1efb79[_0xbb799d(0x281)]['field'];let _0x206efd=_0x1efb79[_0xbb799d(0x1e8)];[_0xbb799d(0x1bf),'Quantity\x20Delivered',_0xbb799d(0x19c),'Unit\x20Price'][_0xbb799d(0x2e6)](_0x23df8b)&&(_0x206efd=Number(_0x206efd)||0x0),currentItem[_0x50dd98][_0x23df8b]=_0x206efd;});for(let _0x9bc2b1=0x0;_0x9bc2b1<currentItem[_0x33f005(0x20e)];_0x9bc2b1++){const _0x244127=currentItem[_0x9bc2b1],_0x817d76=Number(_0x244127[_0x33f005(0x1bf)])||0x0,_0x5a6443=Number(_0x244127[_0x33f005(0x21f)])||0x0,_0x5dd38f=Number(_0x244127['Quantity\x20Cancelled'])||0x0;if(_0x5a6443+_0x5dd38f>_0x817d76){alert(_0x33f005(0x228)+(_0x244127[_0x33f005(0x2a1)]||_0x33f005(0x1ad)+(_0x9bc2b1+0x1))+'\x22,\x20Delivered\x20('+_0x5a6443+_0x33f005(0x26e)+_0x5dd38f+_0x33f005(0x256)+_0x817d76+').'),_0x4c3217=!![];break;}}if(_0x4c3217)return;saveUpdateBtn[_0x33f005(0x1b8)]=!![],saveUpdateBtn[_0x33f005(0x334)]=_0x33f005(0x316);const _0x3748d6=computeAggregatedStatus(currentItem),_0xc82873=firestore[_0x33f005(0x329)]();currentItem[_0x33f005(0x37e)]((_0xbb6cbc,_0x559f33)=>{const _0x24b8ad=_0x33f005,_0x15ad45=Number(_0xbb6cbc[_0x24b8ad(0x1bf)])||0x0,_0x4e5ac7=Number(_0xbb6cbc[_0x24b8ad(0x21f)])||0x0,_0x2c63ff=Number(_0xbb6cbc[_0x24b8ad(0x19c)])||0x0;_0xbb6cbc[_0x24b8ad(0x1e4)]=_0x15ad45-_0x4e5ac7-_0x2c63ff;const _0x598930=document[_0x24b8ad(0x1e1)](_0x24b8ad(0x1f4)+_0x559f33+'\x22]');_0x598930&&(_0xbb6cbc[_0x24b8ad(0x2ac)]=_0x598930['value']||'');_0xbb6cbc[_0x24b8ad(0x2c4)]=_0x3748d6;const _0xadf596=firestore['collection'](_0x24b8ad(0x247))[_0x24b8ad(0x208)](currentUserId)[_0x24b8ad(0x22a)](_0x24b8ad(0x1c1))[_0x24b8ad(0x208)](_0xbb6cbc['docId']);_0xc82873[_0x24b8ad(0x20f)](_0xadf596,_0xbb6cbc);});try{await _0xc82873[_0x33f005(0x19e)](),alert(_0x33f005(0x1c7)),currentItem[_0x33f005(0x37e)](_0x515452=>{const _0x581af1=_0x33f005,_0x4468c3=fullData['findIndex'](_0x2983d9=>_0x2983d9[_0x581af1(0x277)]===_0x515452[_0x581af1(0x277)]);if(_0x4468c3!==-0x1)fullData[_0x4468c3]={..._0x515452};}),filterTable(),updateOrderModal[_0x33f005(0x31a)]();}catch(_0x326449){console['error']('‚ùå\x20Update\x20failed:',_0x326449),alert(_0x33f005(0x22b));}finally{saveUpdateBtn[_0x33f005(0x1b8)]=![],saveUpdateBtn[_0x33f005(0x334)]=_0x33f005(0x2c2);}});async function saveOrdersToFirestore(_0x32f3e0,_0x356465){const _0x447047=_0x241251;console['log'](_0x447047(0x301),_0x356465);const _0x272f9c=firestore[_0x447047(0x329)](),_0xeb0e2e=firestore[_0x447047(0x22a)](_0x447047(0x247))[_0x447047(0x208)](_0x32f3e0)[_0x447047(0x22a)](_0x447047(0x1c1)),_0x4f8d00=await _0xeb0e2e[_0x447047(0x2ea)]();_0x4f8d00[_0x447047(0x37e)](_0x1f04f1=>_0x272f9c[_0x447047(0x24d)](_0x1f04f1[_0x447047(0x2d3)])),_0x356465[_0x447047(0x37e)]((_0x1386f6,_0x11806f)=>{const _0x40a5a3=_0x447047,_0x2ba283=(_0x1386f6[_0x40a5a3(0x257)]||_0x40a5a3(0x216))+'-'+_0x11806f;_0x1386f6[_0x40a5a3(0x277)]=_0x2ba283;const _0x347c56=_0xeb0e2e[_0x40a5a3(0x208)](_0x2ba283);_0x272f9c['set'](_0x347c56,_0x1386f6);}),await _0x272f9c[_0x447047(0x19e)]();}function determineStatus(_0x22f286){const _0xf06892=_0x241251,_0x5b4794=Number(_0x22f286[_0xf06892(0x19c)])||0x0,_0x15f2ac=Number(_0x22f286[_0xf06892(0x1bf)])||0x0,_0x90b23d=Number(_0x22f286[_0xf06892(0x21f)])||0x0,_0x3ab5a6=_0x22f286[_0xf06892(0x35e)]?new Date(_0x22f286[_0xf06892(0x35e)]):null,_0x184822=_0x22f286['Tentative\x20Delivery\x20Date']?new Date(_0x22f286[_0xf06892(0x345)]):null;if(_0x5b4794>0x0)return _0xf06892(0x1ff);else{if(_0x90b23d===0x0&&_0x15f2ac>0x0)return'Pending';else{if(_0x90b23d<_0x15f2ac)return'Partially\x20Delivered';else return _0x90b23d===_0x15f2ac&&_0x3ab5a6&&_0x184822?_0x3ab5a6>_0x184822?_0xf06892(0x264):_0xf06892(0x20b):_0xf06892(0x29c);}}}function getStatusClass(_0x27b7d4){const _0x266aad=_0x241251,_0x24392=_0x27b7d4[_0x266aad(0x2c9)]();return _0x24392===_0x266aad(0x305)?_0x266aad(0x331):_0x24392===_0x266aad(0x235)?'status-cancelled':_0x24392===_0x266aad(0x31e)?_0x266aad(0x224):_0x24392===_0x266aad(0x26c)?_0x266aad(0x2ec):_0x266aad(0x1fb);}function formatDate(_0x1f107c){const _0x89603a=_0x241251;if(!_0x1f107c)return'';let _0x53beb9;if(typeof _0x1f107c==='string'){const _0x137ce7=_0x1f107c[_0x89603a(0x249)](/(\d{1,2})\/(\d{1,2})\/(\d{4})/);_0x53beb9=_0x137ce7?new Date(_0x137ce7[0x3],_0x137ce7[0x1]-0x1,_0x137ce7[0x2]):new Date(_0x1f107c);}else!isNaN(_0x1f107c)&&(_0x53beb9=new Date(Date[_0x89603a(0x21d)](0x76b,0xb,0x1e)+_0x1f107c*0x5265c00));return _0x53beb9 instanceof Date&&!isNaN(_0x53beb9[_0x89603a(0x23e)]())?_0x53beb9[_0x89603a(0x1b3)]('en-US',{'year':'numeric','month':_0x89603a(0x353),'day':_0x89603a(0x1f6)}):'';}function updateSummary(_0x44cf2a){const _0x1cfb78=_0x241251,_0x50514d={};_0x44cf2a[_0x1cfb78(0x37e)](_0x238217=>{const _0x3dc15f=_0x1cfb78,_0x224622=_0x238217[_0x3dc15f(0x257)];if(!_0x224622)return;!_0x50514d[_0x224622]&&(_0x50514d[_0x224622]=[]),_0x50514d[_0x224622][_0x3dc15f(0x1aa)]({'ordered':Number(_0x238217[_0x3dc15f(0x1bf)]||0x0),'delivered':Number(_0x238217['Quantity\x20Delivered']||0x0),'cancelled':Number(_0x238217[_0x3dc15f(0x19c)]||0x0)});});let _0x19bf82=0x0,_0x24e9e=0x0,_0xb13151=0x0,_0x2a645e=0x0;for(const _0x485991 in _0x50514d){const _0xe638f9=_0x50514d[_0x485991];let _0x4947ad=!![],_0x390183=![],_0x2556d0=!![],_0x543f0c=![];_0xe638f9[_0x1cfb78(0x37e)](_0xfa81fb=>{const _0x205a87=_0x1cfb78;if(_0xfa81fb[_0x205a87(0x235)]>0x0)_0x543f0c=!![];if(_0xfa81fb[_0x205a87(0x305)]!==_0xfa81fb[_0x205a87(0x360)])_0x4947ad=![];if(_0xfa81fb['delivered']>0x0)_0x390183=!![];if(_0xfa81fb['delivered']>0x0)_0x2556d0=![];});if(_0x543f0c)_0x2a645e++;else{if(_0x4947ad)_0x19bf82++;else{if(_0x390183)_0x24e9e++;else _0x2556d0&&_0xb13151++;}}}const _0x333c53=Object[_0x1cfb78(0x191)](_0x50514d)[_0x1cfb78(0x20e)];document['getElementById'](_0x1cfb78(0x1d7))[_0x1cfb78(0x334)]=_0x333c53,document['getElementById'](_0x1cfb78(0x30e))[_0x1cfb78(0x334)]=_0x19bf82,document[_0x1cfb78(0x1d8)](_0x1cfb78(0x2d4))[_0x1cfb78(0x334)]=_0x2a645e,document[_0x1cfb78(0x1d8)](_0x1cfb78(0x238))['textContent']=_0xb13151;const _0x239c1b=document[_0x1cfb78(0x1d8)](_0x1cfb78(0x2fc));if(_0x239c1b)_0x239c1b['textContent']=_0x24e9e;}function generateGroupedStatuses(_0x47f03a){const _0x489d37=_0x241251,_0x53000f={},_0x3d8df4=_0x47f03a[_0x489d37(0x33b)]((_0x5d6fd3,_0xc0d789)=>{const _0x570b3f=_0x489d37,_0x11d27c=_0xc0d789[_0x570b3f(0x257)];if(!_0x5d6fd3[_0x11d27c])_0x5d6fd3[_0x11d27c]=[];return _0x5d6fd3[_0x11d27c][_0x570b3f(0x1aa)](_0xc0d789),_0x5d6fd3;},{});for(const _0x16c77b in _0x3d8df4){const _0x2aefbf=_0x3d8df4[_0x16c77b];let _0x3be75b=!![],_0x1bb564=![],_0x4bc6e4=![];for(const _0x44ade3 of _0x2aefbf){const _0xccf72b=Number(_0x44ade3[_0x489d37(0x1bf)])||0x0,_0x352ebb=Number(_0x44ade3['Quantity\x20Delivered'])||0x0,_0x3111e2=Number(_0x44ade3[_0x489d37(0x19c)])||0x0;if(_0x352ebb>0x0)_0x1bb564=!![];if(_0x3111e2>0x0)_0x4bc6e4=!![];if(_0x352ebb<_0xccf72b)_0x3be75b=![];}if(_0x3be75b&&_0x1bb564)_0x53000f[_0x16c77b]=_0x489d37(0x1ef);else{if(_0x1bb564)_0x53000f[_0x16c77b]=_0x489d37(0x33a);else _0x4bc6e4?_0x53000f[_0x16c77b]=_0x489d37(0x1ff):_0x53000f[_0x16c77b]='In\x20Progress';}}return _0x53000f;}function filterTable(){const _0x536861=_0x241251,_0x5c6941=generateGroupedStatuses(fullData),_0x287446=fullData[_0x536861(0x2c0)](_0x44da17=>{const _0x5e2325=_0x536861,_0xcaa957=_0x44da17['Customer']??_0x44da17[_0x5e2325(0x346)]??'',_0x3b1c9e=_0x44da17[_0x5e2325(0x2a1)]??_0x44da17[_0x5e2325(0x37a)]??'',_0x10efa4=String(_0xcaa957)[_0x5e2325(0x2c9)](),_0x5520b3=String(_0x3b1c9e)[_0x5e2325(0x2c9)](),_0x32aadc=_0x44da17[_0x5e2325(0x257)],_0x137bdc=_0x5c6941[_0x32aadc]?.[_0x5e2325(0x2c9)]()||'';let _0x152b40=!![];if(currentMonthSort&&_0x44da17[_0x5e2325(0x321)]){const _0x46cc29=_0x44da17['Order\x20Date'],_0x54a900=new Date(_0x46cc29);if(!isNaN(_0x54a900)){const _0x837212=_0x54a900['toLocaleString']('default',{'month':_0x5e2325(0x353)})['toLowerCase']();_0x152b40=_0x837212===currentMonthSort[_0x5e2325(0x2c9)]();}else _0x152b40=![];}const _0x2c9e89=!currentSearch||_0x10efa4[_0x5e2325(0x2e6)](currentSearch)||_0x5520b3[_0x5e2325(0x2e6)](currentSearch),_0x97247f=!currentStatus||currentStatus[_0x5e2325(0x2c9)]()===_0x5e2325(0x1c2)||_0x137bdc===currentStatus[_0x5e2325(0x2c9)]();return _0x2c9e89&&_0x97247f&&_0x152b40;});populateTable(_0x287446),updateSummary(_0x287446);if(lastUpdatedOrderNumber){const _0x557ba4=document[_0x536861(0x1e1)](_0x536861(0x243)+lastUpdatedOrderNumber+'\x22]');_0x557ba4&&(_0x557ba4['classList'][_0x536861(0x348)](_0x536861(0x36a)),_0x557ba4[_0x536861(0x1ba)]({'behavior':'smooth','block':_0x536861(0x2a6)}),setTimeout(()=>_0x557ba4['classList'][_0x536861(0x203)](_0x536861(0x36a)),0x7d0)),lastUpdatedOrderNumber=null;}}document[_0x241251(0x2e3)](_0x241251(0x26f),()=>{const _0x5db981=_0x241251,_0x1ed6b2=document['getElementById'](_0x5db981(0x1a2)),_0x29a348=document[_0x5db981(0x1d8)]('statusFilter'),_0x11d521=document['getElementById'](_0x5db981(0x270));currentSearch=_0x1ed6b2[_0x5db981(0x1e8)][_0x5db981(0x34f)]()[_0x5db981(0x2c9)](),currentStatus=_0x29a348[_0x5db981(0x1e8)],currentMonthSort=_0x11d521[_0x5db981(0x1e8)],_0x1ed6b2[_0x5db981(0x2e3)](_0x5db981(0x1e3),_0x2fe27c=>{const _0x57f9c5=_0x5db981;currentSearch=_0x2fe27c[_0x57f9c5(0x214)]['value'][_0x57f9c5(0x34f)]()[_0x57f9c5(0x2c9)](),filterTable();}),_0x29a348['addEventListener'](_0x5db981(0x217),_0x544d07=>{const _0x5ec663=_0x5db981;currentStatus=_0x544d07[_0x5ec663(0x214)][_0x5ec663(0x1e8)],filterTable();}),_0x11d521[_0x5db981(0x2e3)](_0x5db981(0x217),_0x58e8da=>{const _0x4ea408=_0x5db981;currentMonthSort=_0x58e8da[_0x4ea408(0x214)][_0x4ea408(0x1e8)],filterTable();}),filterTable();});function _0x5ed1(_0x5b3c92,_0x464619){const _0x49633a=_0x4963();return _0x5ed1=function(_0x5ed173,_0x56621f){_0x5ed173=_0x5ed173-0x18e;let _0x1100b7=_0x49633a[_0x5ed173];return _0x1100b7;},_0x5ed1(_0x5b3c92,_0x464619);}function submitRemarks(){const _0x426ada=_0x241251,_0x53d959=document[_0x426ada(0x1d8)]('newRemarks')[_0x426ada(0x1e8)][_0x426ada(0x34f)](),_0x523b88=currentEditingOrderId;if(!_0x523b88||!currentUserId)return;firestore['collection'](_0x426ada(0x247))['doc'](currentUserId)[_0x426ada(0x22a)](_0x426ada(0x1c1))[_0x426ada(0x208)](_0x523b88)[_0x426ada(0x20f)]({'REMARKS':_0x53d959})[_0x426ada(0x366)](()=>{const _0x2d5cfd=_0x426ada;alert('‚úÖ\x20Order\x20updated\x20successfully.\x20Status:\x20'+newStatus),currentItem['forEach'](_0x2cf7f3=>{const _0x4706c1=_0x5ed1,_0x578ffd=fullData[_0x4706c1(0x275)](_0x2eefe0=>_0x2eefe0[_0x4706c1(0x277)]===_0x2cf7f3[_0x4706c1(0x277)]);if(_0x578ffd!==-0x1)fullData[_0x578ffd]={..._0x2cf7f3};}),filterTable(),updateOrderModal[_0x2d5cfd(0x31a)]();})[_0x426ada(0x37b)](_0x43e31e=>console[_0x426ada(0x332)](_0x426ada(0x273),_0x43e31e));const _0x3032df=document[_0x426ada(0x1d8)]('editModal'),_0x341436=bootstrap[_0x426ada(0x25d)][_0x426ada(0x23d)](_0x3032df);_0x341436['hide']();}function renderCharts(_0x254d58){const _0x4db515=_0x241251,_0x43346f=document['getElementById'](_0x4db515(0x318))?.[_0x4db515(0x1e8)]||'ALL',_0xc834dd={},_0xb04d89={},_0x58582a={},_0x350f1a=new Set();_0x254d58[_0x4db515(0x37e)](_0x888b22=>{const _0x11c7fd=_0x4db515,_0x29c0a4=_0x888b22['Order\x20Date'],_0x3ede7a=_0x888b22['Currency']||_0x11c7fd(0x369),_0x1c4f80=parseFloat(_0x888b22[_0x11c7fd(0x330)]||0x0),_0x3e47fe=parseFloat(_0x888b22[_0x11c7fd(0x1bf)]||0x0),_0x51f9ba=new Date(_0x888b22[_0x11c7fd(0x35e)]),_0x355b6b=new Date(_0x888b22['Tentative\x20Delivery\x20Date']),_0x3ee341=_0x888b22[_0x11c7fd(0x257)];if(!_0x29c0a4||isNaN(_0x1c4f80)||isNaN(_0x3e47fe))return;const _0x1788c3=new Date(_0x29c0a4),_0x3e9775=_0x1788c3[_0x11c7fd(0x349)]('default',{'month':_0x11c7fd(0x2f8),'year':_0x11c7fd(0x1f6)});(_0x43346f==='ALL'||_0x43346f===_0x3ede7a)&&(_0xc834dd[_0x3e9775]=(_0xc834dd[_0x3e9775]||0x0)+_0x3e47fe*_0x1c4f80);_0x3ee341&&!_0x350f1a['has'](_0x3ee341)&&(_0x350f1a[_0x11c7fd(0x348)](_0x3ee341),_0x58582a[_0x3e9775]=(_0x58582a[_0x3e9775]||0x0)+0x1);if(!isNaN(_0x51f9ba)&&!isNaN(_0x355b6b)){const _0x3c75e3=_0x51f9ba[_0x11c7fd(0x23e)]()<=_0x355b6b[_0x11c7fd(0x23e)]();if(!_0xb04d89[_0x3e9775])_0xb04d89[_0x3e9775]={'onTime':0x0,'delayed':0x0};_0x3c75e3?_0xb04d89[_0x3e9775][_0x11c7fd(0x21b)]++:_0xb04d89[_0x3e9775][_0x11c7fd(0x196)]++;}});const _0x207b6e=[...new Set([...Object[_0x4db515(0x191)](_0xc834dd),...Object[_0x4db515(0x191)](_0x58582a),...Object[_0x4db515(0x191)](_0xb04d89)])]['sort']((_0x4b2e86,_0x4451a5)=>new Date(_0x4b2e86)-new Date(_0x4451a5)),_0x20a025=_0x207b6e['map'](_0x485825=>_0xc834dd[_0x485825]||0x0),_0x19b2a5=document[_0x4db515(0x1d8)](_0x4db515(0x2a2))['getContext']('2d');if(chartInstance)chartInstance[_0x4db515(0x389)]();const _0x19365d=chart1Type===_0x4db515(0x1ca),_0x4a8595=_0x19365d?_0x4db515(0x1a4):chart1Type;chartInstance=new Chart(_0x19b2a5,{'type':_0x4a8595,'data':{'labels':_0x207b6e,'datasets':[{'label':_0x4db515(0x29d)+_0x43346f+')','data':_0x20a025,'borderColor':_0x4db515(0x258),'backgroundColor':_0x19365d?_0x4db515(0x1fd):_0x4db515(0x27e),'fill':_0x19365d,'tension':0.4,'borderWidth':2.5,'pointRadius':0x4}]},'options':{'responsive':!![],'maintainAspectRatio':![],'plugins':{'tooltip':{'callbacks':{'label':_0x157046=>_0x43346f+'\x20'+_0x157046[_0x4db515(0x218)]['y']['toFixed'](0x2)}}},'scales':{'y':{'beginAtZero':!![],'ticks':{'callback':_0x3b96fd=>_0x43346f+'\x20'+_0x3b96fd[_0x4db515(0x349)]()}}}}});const _0x33709a=_0x207b6e['map'](_0x426810=>_0x58582a[_0x426810]||0x0),_0xf66038=document['getElementById'](_0x4db515(0x1cd))[_0x4db515(0x2dd)]('2d');if(ordersChartInstance)ordersChartInstance[_0x4db515(0x389)]();const _0x3d00e2=chart2Type===_0x4db515(0x1ca),_0x57e4fb=_0x3d00e2?_0x4db515(0x1a4):chart2Type;ordersChartInstance=new Chart(_0xf66038,{'type':_0x57e4fb,'data':{'labels':_0x207b6e,'datasets':[{'label':'Orders\x20Issued','data':_0x33709a,'backgroundColor':_0x3d00e2?_0x4db515(0x2d2):_0x4db515(0x2f4),'borderColor':_0x4db515(0x2f4),'fill':_0x3d00e2,'tension':0.4,'borderWidth':2.5,'pointRadius':0x4,'borderRadius':_0x3d00e2?0x0:0x8}]},'options':{'responsive':!![],'maintainAspectRatio':![],'layout':{'padding':{'top':0x14,'bottom':0x28,'left':0xa,'right':0xa}},'plugins':{'legend':{'position':_0x4db515(0x2cd)},'tooltip':{'callbacks':{'label':_0x22a57b=>_0x22a57b[_0x4db515(0x218)]['y']+_0x4db515(0x29a)}},'datalabels':{'anchor':_0x4db515(0x1f0),'align':_0x4db515(0x205),'color':'#1d1d1f','font':{'weight':_0x4db515(0x282),'size':0xb},'clamp':!![],'clip':![],'formatter':_0x465ade=>_0x465ade}},'scales':{'y':{'beginAtZero':!![],'ticks':{'stepSize':0x1,'padding':0x8}},'x':{'ticks':{'autoSkip':![],'maxRotation':0x0,'minRotation':0x0,'padding':0xa}}}},'plugins':[ChartDataLabels]});const _0x3035da=_0x207b6e[_0x4db515(0x2ed)](_0x708c8a=>_0xb04d89[_0x708c8a]?.['onTime']||0x0),_0x2d690a=_0x207b6e[_0x4db515(0x2ed)](_0x3a5053=>_0xb04d89[_0x3a5053]?.[_0x4db515(0x196)]||0x0),_0x292c6a=_0x207b6e[_0x4db515(0x2ed)]((_0x1451bf,_0x1ab1f2)=>_0x3035da[_0x1ab1f2]+_0x2d690a[_0x1ab1f2]),_0x4a55cb=_0x3035da[_0x4db515(0x2ed)]((_0x90c7c2,_0x2220d2)=>_0x292c6a[_0x2220d2]?_0x90c7c2/_0x292c6a[_0x2220d2]*0x64:0x0),_0x5697ce=_0x2d690a['map']((_0x52d2a1,_0xbdd0c)=>_0x292c6a[_0xbdd0c]?_0x52d2a1/_0x292c6a[_0xbdd0c]*0x64:0x0),_0x1353d8=document[_0x4db515(0x1d8)]('onTimeDelayedChart')?.[_0x4db515(0x2dd)]('2d');if(_0x1353d8){if(window['onTimeDelayedChartInstance'])window[_0x4db515(0x327)][_0x4db515(0x389)]();window[_0x4db515(0x327)]=new Chart(_0x1353d8,{'type':'bar','data':{'labels':_0x207b6e,'datasets':[{'label':'On\x20Time\x20(%)','data':_0x4a55cb,'backgroundColor':_0x4db515(0x2f4)},{'label':_0x4db515(0x19f),'data':_0x5697ce,'backgroundColor':_0x4db515(0x24f)}]},'options':{'responsive':!![],'maintainAspectRatio':![],'interaction':{'mode':_0x4db515(0x24c),'intersect':![]},'plugins':{'tooltip':{'callbacks':{'label':_0x2c2ee2=>_0x2c2ee2[_0x4db515(0x281)]['label']+':\x20'+_0x2c2ee2[_0x4db515(0x218)]['y'][_0x4db515(0x33e)](0x1)+'%'}},'datalabels':{'anchor':_0x4db515(0x1f0),'align':_0x4db515(0x205),'formatter':_0x25b72e=>_0x25b72e['toFixed'](0x1)+'%','color':_0x4db515(0x1a6),'font':{'weight':_0x4db515(0x282)}},'legend':{'position':_0x4db515(0x2cd)},'title':{'display':!![],'text':'Monthly\x20On\x20Time\x20vs\x20Delayed\x20Orders\x20(%)'}},'scales':{'y':{'beginAtZero':!![],'max':0x64,'ticks':{'callback':_0x27b1f1=>_0x27b1f1+'%'},'title':{'display':!![],'text':_0x4db515(0x20a)}},'x':{'title':{'display':!![],'text':'Month'}}}},'plugins':[ChartDataLabels]});}}document['getElementById'](_0x241251(0x37f))[_0x241251(0x2e3)]('click',()=>{const _0x25d2ed=_0x241251,_0x165db7=localStorage[_0x25d2ed(0x2b5)](_0x25d2ed(0x27b))||_0x25d2ed(0x1a4),_0x4ae536=localStorage[_0x25d2ed(0x2b5)](_0x25d2ed(0x325))||_0x25d2ed(0x31d);document['getElementById'](_0x25d2ed(0x27b))[_0x25d2ed(0x1e8)]=_0x165db7,document[_0x25d2ed(0x1d8)](_0x25d2ed(0x325))['value']=_0x4ae536;const _0x3a802d=new bootstrap[(_0x25d2ed(0x25d))](document[_0x25d2ed(0x1d8)](_0x25d2ed(0x1c6)));_0x3a802d[_0x25d2ed(0x215)]();}),document['getElementById'](_0x241251(0x28e))['addEventListener']('click',()=>{const _0x374928=_0x241251;chart1Type=document['getElementById'](_0x374928(0x27b))['value'],chart2Type=document[_0x374928(0x1d8)](_0x374928(0x325))[_0x374928(0x1e8)],localStorage[_0x374928(0x253)](_0x374928(0x27b),chart1Type),localStorage[_0x374928(0x253)](_0x374928(0x325),chart2Type),renderCharts(fullData);const _0x337902=document[_0x374928(0x1d8)]('customizeChartModal'),_0x47e650=bootstrap[_0x374928(0x25d)][_0x374928(0x23d)](_0x337902);_0x47e650[_0x374928(0x31a)]();}),document[_0x241251(0x1d8)]('currencySelector')['addEventListener']('change',()=>{renderCharts(fullData);}),document['getElementById'](_0x241251(0x1ed))[_0x241251(0x2e3)]('click',()=>{const _0x26a89f=_0x241251,_0x25479f=document[_0x26a89f(0x1d8)]('orderTableBody');if(!_0x25479f)return;const _0x56dddf=Array[_0x26a89f(0x1f1)](_0x25479f[_0x26a89f(0x379)]('tr'));if(_0x56dddf[_0x26a89f(0x20e)]===0x0){alert(_0x26a89f(0x338));return;}const _0x1508f2=_0x56dddf[_0x26a89f(0x2ed)](_0x475a6c=>{const _0x2a326b=_0x26a89f,_0x2b9f6d=_0x475a6c[_0x2a326b(0x379)]('td'),_0x3c36b8={};return selectedColumns[_0x2a326b(0x37e)]((_0x4976ea,_0x31a68e)=>{const _0x4ec029=_0x2a326b,_0x475504=_0x2b9f6d[_0x31a68e];if(!_0x475504)_0x3c36b8[_0x4976ea]='';else{const _0x2492d2=_0x475504['querySelector'](_0x4ec029(0x28c));_0x2492d2?_0x3c36b8[_0x4976ea]=_0x2492d2['value']:_0x3c36b8[_0x4976ea]=_0x475504[_0x4ec029(0x334)][_0x4ec029(0x34f)]();}}),_0x3c36b8;}),_0xf07fbe=XLSX[_0x26a89f(0x315)][_0x26a89f(0x25f)](_0x1508f2),_0x1c87e0=XLSX[_0x26a89f(0x315)][_0x26a89f(0x2ad)]();XLSX[_0x26a89f(0x315)][_0x26a89f(0x2e4)](_0x1c87e0,_0xf07fbe,_0x26a89f(0x34c));const _0x16c732='Filtered_Orders_'+new Date()[_0x26a89f(0x36e)]()[_0x26a89f(0x1be)](0x0,0xa)+_0x26a89f(0x1e0);XLSX[_0x26a89f(0x22e)](_0x1c87e0,_0x16c732);}),document[_0x241251(0x2e3)](_0x241251(0x26f),()=>{const _0x4d4711=_0x241251;document[_0x4d4711(0x1d8)](_0x4d4711(0x21a))[_0x4d4711(0x2e3)](_0x4d4711(0x2ce),_0x388f1d=>{const _0x4f0ae5=_0x4d4711;_0x388f1d[_0x4f0ae5(0x1fe)]();const _0x51f861=document[_0x4f0ae5(0x1d8)](_0x4f0ae5(0x319));_0x51f861[_0x4f0ae5(0x2df)]=_0x4f0ae5(0x34e);const _0x26490f=[...new Set(fullData['map'](_0x23e093=>_0x23e093['Supplier'])[_0x4f0ae5(0x2c0)](Boolean))];_0x26490f[_0x4f0ae5(0x37e)](_0x235e3d=>{const _0x4a9121=_0x4f0ae5,_0x57f85a=document['createElement'](_0x4a9121(0x2f5));_0x57f85a[_0x4a9121(0x1e8)]=_0x235e3d,_0x57f85a['textContent']=_0x235e3d,_0x51f861['appendChild'](_0x57f85a);});const _0x145813=new bootstrap[(_0x4f0ae5(0x25d))](document['getElementById'](_0x4f0ae5(0x2f2)));_0x145813['show']();}),document[_0x4d4711(0x1d8)](_0x4d4711(0x313))['addEventListener']('click',()=>{const _0x2aff19=_0x4d4711,_0x941206=document['getElementById'](_0x2aff19(0x319))[_0x2aff19(0x1e8)];if(!_0x941206)return;const _0x18fffa=document[_0x2aff19(0x1d8)](_0x2aff19(0x24b)),_0x495506=document[_0x2aff19(0x1d8)](_0x2aff19(0x1cf)),_0x17e045=fullData['filter'](_0x3cda5c=>{const _0x29afcd=_0x2aff19,_0x23a3f4=Number(_0x3cda5c['Quantity\x20Delivered']||0x0),_0x97e4d1=Number(_0x3cda5c[_0x29afcd(0x1bf)]||0x0),_0x199257=Number(_0x3cda5c[_0x29afcd(0x19c)]||0x0),_0x1b21b3=_0x199257===0x0&&_0x23a3f4<_0x97e4d1;return _0x3cda5c[_0x29afcd(0x346)]===_0x941206&&_0x1b21b3;});_0x495506[_0x2aff19(0x334)]=_0x941206,_0x18fffa[_0x2aff19(0x2df)]='',_0x17e045[_0x2aff19(0x37e)](_0x410b00=>{const _0x456c59=_0x2aff19,_0x1b445d=(_0x410b00['Quantity\x20Ordered']||0x0)-(_0x410b00['Quantity\x20Delivered']||0x0),_0x3d0f1a=_0x410b00[_0x456c59(0x2be)]||'',_0x1e695e=document['createElement']('tr');_0x1e695e['innerHTML']=_0x456c59(0x1e9)+(_0x410b00[_0x456c59(0x257)]||'')+'</td>\x0a\x20\x20<td>'+(_0x410b00[_0x456c59(0x2a1)]||_0x410b00['Description']||'')+_0x456c59(0x2cb)+(_0x410b00[_0x456c59(0x330)]||0x0)+_0x456c59(0x2cb)+(_0x410b00[_0x456c59(0x1bf)]||0x0)+_0x456c59(0x2cb)+(_0x410b00['Amount']||0x0)+_0x456c59(0x2cb)+(_0x410b00[_0x456c59(0x21f)]||0x0)+_0x456c59(0x2cb)+(_0x410b00[_0x456c59(0x19c)]||0x0)+_0x456c59(0x2cb)+_0x1b445d+_0x456c59(0x2cb)+(_0x410b00['Need\x20By\x20Date']||'')+'</td>\x0a\x20\x20<td\x20class=\x22remarks-cell\x22\x20data-full-text=\x22'+_0x3d0f1a[_0x456c59(0x240)](/"/g,'&quot;')+'\x22>'+_0x3d0f1a+_0x456c59(0x1a8),_0x18fffa[_0x456c59(0x1a1)](_0x1e695e);});function _0x465424(_0x44634c){const _0x397a48=_0x2aff19,_0x137e38=document[_0x397a48(0x1e1)](_0x44634c),_0x1b1aa9=_0x137e38[_0x397a48(0x379)]('th');_0x1b1aa9['forEach']((_0x24609b,_0x49ed2e)=>{const _0x10e897=_0x397a48,_0x2a91e3=_0x24609b[_0x10e897(0x1e1)](_0x10e897(0x2d0));if(_0x2a91e3)_0x2a91e3[_0x10e897(0x203)]();const _0x7c5975=document[_0x10e897(0x2de)](_0x10e897(0x1b5));_0x7c5975[_0x10e897(0x28a)][_0x10e897(0x348)]('column-resizer'),_0x7c5975[_0x10e897(0x190)][_0x10e897(0x32e)]=_0x10e897(0x1a9),_0x7c5975[_0x10e897(0x190)][_0x10e897(0x1b2)]='100%',_0x7c5975[_0x10e897(0x190)][_0x10e897(0x350)]='absolute',_0x7c5975[_0x10e897(0x190)]['right']='0',_0x7c5975[_0x10e897(0x190)][_0x10e897(0x205)]='0',_0x7c5975[_0x10e897(0x190)][_0x10e897(0x276)]=_0x10e897(0x2fb),_0x7c5975['style'][_0x10e897(0x30f)]=_0x10e897(0x272),_0x7c5975[_0x10e897(0x190)][_0x10e897(0x1d2)]='1',_0x24609b['style']['position']='relative',_0x24609b[_0x10e897(0x1a1)](_0x7c5975),_0x7c5975['addEventListener'](_0x10e897(0x344),_0x4a405d=>{const _0x138d0b=_0x10e897;_0x4a405d[_0x138d0b(0x1fe)]();const _0x315a8b=_0x4a405d[_0x138d0b(0x30b)],_0x47ddd5=_0x24609b[_0x138d0b(0x1c0)],_0x30d2a2=_0x3429c8=>{const _0x4592f5=_0x138d0b,_0x44feb5=_0x47ddd5+(_0x3429c8[_0x4592f5(0x30b)]-_0x315a8b);_0x24609b[_0x4592f5(0x190)][_0x4592f5(0x32e)]=_0x44feb5+'px',_0x137e38[_0x4592f5(0x379)]('tr')[_0x4592f5(0x37e)](_0x14e089=>{const _0x3a7734=_0x4592f5,_0x35511b=_0x14e089[_0x3a7734(0x347)][_0x49ed2e];if(_0x35511b)_0x35511b[_0x3a7734(0x190)][_0x3a7734(0x32e)]=_0x44feb5+'px';});},_0x48f11c=()=>{const _0x42b739=_0x138d0b;document[_0x42b739(0x248)](_0x42b739(0x2a8),_0x30d2a2),document[_0x42b739(0x248)](_0x42b739(0x2e7),_0x48f11c);};document['addEventListener'](_0x138d0b(0x2a8),_0x30d2a2),document['addEventListener'](_0x138d0b(0x2e7),_0x48f11c);});});}_0x465424(_0x2aff19(0x387));function _0x84035c(_0x184c44,_0x2f9aba=_0x2aff19(0x236)){const _0x29eb4e=_0x2aff19,_0x4b5045=document[_0x29eb4e(0x1d8)](_0x184c44),_0x539176=Array[_0x29eb4e(0x1f1)](_0x4b5045['querySelectorAll']('tr')),_0x3052ce=_0x539176[_0x29eb4e(0x2ed)](_0x39c034=>Array[_0x29eb4e(0x1f1)](_0x39c034[_0x29eb4e(0x379)](_0x29eb4e(0x1d6)))[_0x29eb4e(0x2ed)](_0x1a2d62=>'\x22'+_0x1a2d62['innerText'][_0x29eb4e(0x240)](/"/g,'\x22\x22')+'\x22')[_0x29eb4e(0x333)](','))[_0x29eb4e(0x333)]('\x0a'),_0x216a52=new Blob([_0x3052ce],{'type':'text/csv;charset=utf-8;'}),_0x17610f=document[_0x29eb4e(0x2de)]('a');_0x17610f[_0x29eb4e(0x311)]=URL[_0x29eb4e(0x380)](_0x216a52),_0x17610f[_0x29eb4e(0x2b1)]=_0x2f9aba,_0x17610f[_0x29eb4e(0x2ce)]();}document[_0x2aff19(0x1d8)](_0x2aff19(0x2b6))[_0x2aff19(0x2e3)](_0x2aff19(0x2ce),()=>{_0x84035c('followUpReportTable');});const _0x14a0c6=new bootstrap['Modal'](document[_0x2aff19(0x1d8)](_0x2aff19(0x198)));_0x14a0c6['show']();const _0x94bcf5=bootstrap[_0x2aff19(0x25d)][_0x2aff19(0x23d)](document[_0x2aff19(0x1d8)](_0x2aff19(0x2f2)));_0x94bcf5['hide']();});});function computeTentativeDate(_0x1bf223,_0x362248){const _0x5e61ce=_0x241251;if(!_0x1bf223||!_0x362248||_0x362248===_0x5e61ce(0x342))return'';const _0x87aa42=new Date(_0x1bf223);let _0x1a9f2d=0x0;if(_0x362248[_0x5e61ce(0x2e6)](_0x5e61ce(0x266))){const _0x41eb3a=_0x362248[_0x5e61ce(0x2a0)]('-'),_0x1ba961=parseInt(_0x41eb3a[0x1])||parseInt(_0x41eb3a[0x0])||0x0;_0x1a9f2d=_0x1ba961*0x5;}else{if(_0x362248[_0x5e61ce(0x2e6)](_0x5e61ce(0x2db))){const _0x4ce97a=_0x362248[_0x5e61ce(0x2a0)]('-'),_0x5b0c68=parseInt(_0x4ce97a[0x1])||parseInt(_0x4ce97a[0x0])||0x0;_0x1a9f2d=_0x5b0c68;}}let _0x4c1a40=0x0,_0x229a80=new Date(_0x87aa42);while(_0x4c1a40<_0x1a9f2d){_0x229a80['setDate'](_0x229a80[_0x5e61ce(0x343)]()+0x1);const _0x45ec50=_0x229a80[_0x5e61ce(0x1bb)]();if(_0x45ec50!==0x0&&_0x45ec50!==0x6)_0x4c1a40++;}return _0x229a80[_0x5e61ce(0x1b3)](_0x5e61ce(0x357),{'year':_0x5e61ce(0x1f6),'month':'long','day':_0x5e61ce(0x1f6)});}document[_0x241251(0x1d8)](_0x241251(0x34a))[_0x241251(0x2e3)](_0x241251(0x2ce),async()=>{const _0x1f404b=_0x241251,_0xf59f78=firebase[_0x1f404b(0x336)](),_0xf7fe28=firebase[_0x1f404b(0x1cb)]()['currentUser'];if(!_0xf7fe28){alert(_0x1f404b(0x383));return;}const _0xc33e2f=_0xf59f78[_0x1f404b(0x22a)](_0x1f404b(0x247))[_0x1f404b(0x208)](_0xf7fe28[_0x1f404b(0x384)])[_0x1f404b(0x22a)](_0x1f404b(0x1c1)),_0xea1587=document[_0x1f404b(0x379)](_0x1f404b(0x221));let _0x4a61b1=0x0;for(const _0x2948c6 of _0xea1587){const _0x41b7e9=_0x2948c6[_0x1f404b(0x1e1)](_0x1f404b(0x229))?.[_0x1f404b(0x334)]?.[_0x1f404b(0x34f)]();if(_0x41b7e9===_0x1f404b(0x1ef)||_0x41b7e9===_0x1f404b(0x1ff))continue;const _0x505194=_0x2948c6[_0x1f404b(0x2ab)](_0x1f404b(0x2ba));if(!_0x505194){console[_0x1f404b(0x1f2)](_0x1f404b(0x2f3),_0x2948c6);continue;}const _0x4beb90=parseInt(_0x2948c6['querySelector'](_0x1f404b(0x2fd))?.[_0x1f404b(0x334)]||0x0),_0x826905=parseInt(_0x2948c6[_0x1f404b(0x1e1)](_0x1f404b(0x32d))?.[_0x1f404b(0x334)]||0x0),_0x43f5d6=parseInt(_0x2948c6[_0x1f404b(0x1e1)]('.qtyCancelled')?.[_0x1f404b(0x334)]||0x0);let _0x561cc=_0x1f404b(0x269);if(_0x826905+_0x43f5d6>=_0x4beb90)_0x561cc=_0x1f404b(0x1ef);else _0x826905===0x0&&_0x43f5d6===0x0&&(_0x561cc=_0x1f404b(0x26b));try{await _0xc33e2f[_0x1f404b(0x208)](_0x505194)[_0x1f404b(0x20f)]({'status':_0x561cc}),_0x4a61b1++,console['log'](_0x1f404b(0x2bf)+_0x505194+_0x1f404b(0x30d)+_0x561cc);}catch(_0x1dca2d){console[_0x1f404b(0x332)](_0x1f404b(0x2d1)+_0x505194+':',_0x1dca2d);}}alert('‚úÖ\x20Status\x20Report\x20Updated\x0a'+_0x4a61b1+_0x1f404b(0x1f7));});function generateDeliveryPerformanceReport(_0xe37a53,_0x1950fb){const _0x297628=_0x241251,_0xcfd0c5={};fullData[_0x297628(0x37e)](_0x52ec01=>{const _0x16c736=_0x297628;_0x52ec01[_0x16c736(0x321)]=formatDateDisplay(_0x52ec01[_0x16c736(0x321)]),_0x52ec01['Tentative\x20Delivery\x20Date']=formatDateDisplay(_0x52ec01[_0x16c736(0x345)]),_0x52ec01[_0x16c736(0x35e)]=formatDateDisplay(_0x52ec01[_0x16c736(0x35e)]);const _0x5464b5=new Date(_0x52ec01[_0x16c736(0x321)]);if(_0x5464b5<_0xe37a53||_0x5464b5>=_0x1950fb)return;const _0x1bc6c6=_0x52ec01[_0x16c736(0x346)]||_0x16c736(0x207);if(!_0xcfd0c5[_0x1bc6c6])_0xcfd0c5[_0x1bc6c6]=[];const _0x4125cf=new Date(_0x52ec01[_0x16c736(0x345)]),_0x295f5c=_0x52ec01[_0x16c736(0x35e)]?new Date(_0x52ec01[_0x16c736(0x35e)]):null;let _0x10f877='';if(_0x295f5c&&_0x295f5c<=_0x4125cf)_0x10f877='On\x20Time';else{if(_0x295f5c&&_0x295f5c>_0x4125cf)_0x10f877=_0x16c736(0x264);else!_0x295f5c&&_0x4125cf<new Date()?_0x10f877=_0x16c736(0x264):_0x10f877='Pending';}_0xcfd0c5[_0x1bc6c6][_0x16c736(0x1aa)]({'orderNumber':_0x52ec01[_0x16c736(0x257)]||'N/A','description':_0x52ec01[_0x16c736(0x37a)]||'','orderDate':_0x52ec01[_0x16c736(0x321)]||'','tentativeDate':_0x52ec01[_0x16c736(0x345)]||'','deliveryDate':_0x52ec01[_0x16c736(0x35e)]||'','status':_0x10f877});}),renderDeliveryPerformanceToModal(_0xcfd0c5),new bootstrap[(_0x297628(0x25d))](document[_0x297628(0x1d8)](_0x297628(0x28f)))[_0x297628(0x215)]();}function showExcelUploadModal(){const _0x41b599=_0x241251,_0x50c6ea=new bootstrap[(_0x41b599(0x25d))](document[_0x41b599(0x1d8)]('excelUploadLoaderModal'),{'backdrop':'static','keyboard':![]});_0x50c6ea[_0x41b599(0x215)]();}function updateExcelUploadProgress(_0x2737f6){const _0x18a256=_0x241251,_0x22f11b=document['getElementById']('excelUploadProgressBar');_0x22f11b&&(_0x22f11b[_0x18a256(0x190)]['width']=_0x2737f6+'%',_0x22f11b['textContent']=_0x2737f6+'%');}function hideExcelUploadModal(){const _0x5384ea=_0x241251,_0x5b7b95=document[_0x5384ea(0x1d8)]('excelUploadLoaderModal'),_0x2ae493=bootstrap[_0x5384ea(0x25d)]['getInstance'](_0x5b7b95);if(_0x2ae493)_0x2ae493[_0x5384ea(0x31a)]();updateExcelUploadProgress(0x0);}document['getElementById'](_0x241251(0x2f0))[_0x241251(0x2e3)](_0x241251(0x217),async _0x3f836b=>{const _0x48ec95=_0x241251,_0x1c9b36=_0x3f836b['target'][_0x48ec95(0x211)][0x0];if(!_0x1c9b36)return;const _0x108fad=new FileReader();_0x108fad[_0x48ec95(0x36d)]=async _0x3d2bc2=>{const _0x4c27d9=_0x48ec95,_0x5087a8=new Uint8Array(_0x3d2bc2[_0x4c27d9(0x214)]['result']),_0x5db891=XLSX[_0x4c27d9(0x354)](_0x5087a8,{'type':_0x4c27d9(0x287)}),_0x3b71f2=_0x5db891['SheetNames'][0x0],_0x3b2355=_0x5db891[_0x4c27d9(0x2f7)][_0x3b71f2],_0x5d7406=XLSX[_0x4c27d9(0x315)][_0x4c27d9(0x290)](_0x3b2355),_0x1b71bb=[_0x4c27d9(0x23b),'Date',_0x4c27d9(0x346),_0x4c27d9(0x371),'Receiver'],_0x431fca=document[_0x4c27d9(0x1d8)]('rrReportTableBody'),_0x1f97a4=document[_0x4c27d9(0x1d8)](_0x4c27d9(0x324));_0x1f97a4[_0x4c27d9(0x2df)]='',_0x431fca['innerHTML']='';const _0x1c1872=_0x5d7406[_0x4c27d9(0x2ed)](_0x171438=>{const _0x4be2e6={};return _0x1b71bb['forEach'](_0x303297=>{const _0x44321c=_0x5ed1;_0x4be2e6[_0x303297]=_0x303297===_0x44321c(0x227)?formatDateDisplay(_0x171438[_0x303297]):_0x171438[_0x303297]||'';}),_0x4be2e6;}),_0x2c185f=[..._0x1b71bb],_0x4ae6e9=document['createElement']('tr'),_0x43d0d8=document[_0x4c27d9(0x2de)]('th');_0x43d0d8[_0x4c27d9(0x31f)](_0x4c27d9(0x234),_0x2c185f[_0x4c27d9(0x20e)]),_0x43d0d8[_0x4c27d9(0x22f)]='text-center\x20bg-secondary\x20text-white\x20fs-6',_0x43d0d8[_0x4c27d9(0x334)]='TRANSMITTAL\x20OF\x20INVOICE\x20WITH\x20RECEIVING\x20REPORT\x20CPS',_0x4ae6e9[_0x4c27d9(0x1a1)](_0x43d0d8),_0x1f97a4[_0x4c27d9(0x1a1)](_0x4ae6e9);const _0x48aec2=document[_0x4c27d9(0x2de)]('tr');_0x2c185f[_0x4c27d9(0x37e)](_0x1869af=>{const _0x4d91bd=_0x4c27d9,_0x21c765=document[_0x4d91bd(0x2de)]('th');_0x21c765[_0x4d91bd(0x334)]=_0x1869af,_0x48aec2[_0x4d91bd(0x1a1)](_0x21c765);}),_0x1f97a4['appendChild'](_0x48aec2),_0x1c1872['forEach'](_0x92e158=>{const _0x488fc9=_0x4c27d9,_0x2cd7fd=document[_0x488fc9(0x2de)]('tr');_0x2c185f[_0x488fc9(0x37e)](_0x163c88=>{const _0x13f86e=_0x488fc9,_0x1b9e9a=document[_0x13f86e(0x2de)]('td');_0x1b9e9a[_0x13f86e(0x334)]=_0x92e158[_0x163c88]||'',_0x2cd7fd[_0x13f86e(0x1a1)](_0x1b9e9a);}),_0x431fca[_0x488fc9(0x1a1)](_0x2cd7fd);});const _0x42d705=firebase[_0x4c27d9(0x1cb)]()[_0x4c27d9(0x298)];if(_0x42d705)try{await firebase[_0x4c27d9(0x336)]()[_0x4c27d9(0x22a)](_0x4c27d9(0x2cf))[_0x4c27d9(0x208)](_0x42d705[_0x4c27d9(0x384)])[_0x4c27d9(0x1d5)]({'rrData':_0x1c1872,'allHeaders':_0x2c185f,'timestamp':firebase[_0x4c27d9(0x336)][_0x4c27d9(0x222)][_0x4c27d9(0x2dc)]()}),console[_0x4c27d9(0x355)](_0x4c27d9(0x35b));}catch(_0x436dd0){console[_0x4c27d9(0x332)](_0x4c27d9(0x27a),_0x436dd0);}bootstrap[_0x4c27d9(0x25d)][_0x4c27d9(0x23d)](document[_0x4c27d9(0x1d8)](_0x4c27d9(0x1ec)))?.['hide'](),new bootstrap[(_0x4c27d9(0x25d))](document['getElementById']('rrReportModal'))[_0x4c27d9(0x215)]();},_0x108fad[_0x48ec95(0x2ee)](_0x1c9b36);}),document[_0x241251(0x1d8)]('generateRRReportBtn')[_0x241251(0x2e3)](_0x241251(0x2ce),async()=>{const _0x13e6f2=_0x241251,_0x53504b=firebase['auth']()[_0x13e6f2(0x298)];if(!_0x53504b)return;try{const _0x32bb5e=await firebase[_0x13e6f2(0x336)]()['collection'](_0x13e6f2(0x2cf))[_0x13e6f2(0x208)](_0x53504b[_0x13e6f2(0x384)])[_0x13e6f2(0x2ea)](),_0x537e60=document['getElementById']('rrReportTableHeadRow'),_0x305821=document[_0x13e6f2(0x1d8)](_0x13e6f2(0x1d4));_0x537e60[_0x13e6f2(0x2df)]='',_0x305821[_0x13e6f2(0x2df)]='';if(_0x32bb5e[_0x13e6f2(0x372)]){const _0x2b4cac=_0x32bb5e[_0x13e6f2(0x310)](),_0x30162d=_0x2b4cac['rrData']||[],_0x1e40ee=_0x2b4cac[_0x13e6f2(0x359)]||['Receipt',_0x13e6f2(0x227),_0x13e6f2(0x346),_0x13e6f2(0x371),_0x13e6f2(0x1c4)],_0x39410a=document[_0x13e6f2(0x2de)]('tr'),_0x200f36=document[_0x13e6f2(0x2de)]('th');_0x200f36[_0x13e6f2(0x31f)](_0x13e6f2(0x234),_0x1e40ee[_0x13e6f2(0x20e)]),_0x200f36[_0x13e6f2(0x22f)]='text-center\x20bg-secondary\x20text-white\x20fs-6',_0x200f36[_0x13e6f2(0x334)]=_0x13e6f2(0x23a),_0x39410a['appendChild'](_0x200f36),_0x537e60[_0x13e6f2(0x1a1)](_0x39410a);const _0x15de52=document['createElement']('tr');_0x1e40ee[_0x13e6f2(0x37e)](_0x36b092=>{const _0x3b917a=_0x13e6f2,_0x18ac15=document['createElement']('th');_0x18ac15[_0x3b917a(0x334)]=_0x36b092,_0x15de52[_0x3b917a(0x1a1)](_0x18ac15);}),_0x537e60[_0x13e6f2(0x1a1)](_0x15de52),_0x30162d[_0x13e6f2(0x37e)](_0x232b96=>{const _0x8638f8=_0x13e6f2,_0x43e540=document['createElement']('tr');_0x1e40ee['forEach'](_0x3a8d2d=>{const _0x4b5c3b=_0x5ed1,_0x4c6940=document['createElement']('td');_0x4c6940['textContent']=_0x232b96[_0x3a8d2d]||'',_0x43e540[_0x4b5c3b(0x1a1)](_0x4c6940);}),_0x305821[_0x8638f8(0x1a1)](_0x43e540);}),showCurrencyAssignmentModal(_0x30162d),new bootstrap[(_0x13e6f2(0x25d))](document[_0x13e6f2(0x1d8)]('rrReportModal'))[_0x13e6f2(0x215)]();}else new bootstrap['Modal'](document[_0x13e6f2(0x1d8)](_0x13e6f2(0x1ec)))['show']();}catch(_0xdeff8){console['error']('‚ùå\x20Failed\x20to\x20load\x20RR\x20Report:',_0xdeff8),alert('Failed\x20to\x20load\x20RR\x20Report.\x20Please\x20try\x20again.');}}),document[_0x241251(0x1d8)](_0x241251(0x1af))[_0x241251(0x2e3)](_0x241251(0x2ce),async()=>{const _0x406048=_0x241251,_0x46b2b0=firebase[_0x406048(0x1cb)]()['currentUser']?.[_0x406048(0x384)];if(!_0x46b2b0)return;try{const _0x4a8e38=firebase[_0x406048(0x336)]()[_0x406048(0x22a)](_0x406048(0x2cf))[_0x406048(0x208)](_0x46b2b0),_0x1f8ab6=await _0x4a8e38[_0x406048(0x2ea)]();if(!_0x1f8ab6[_0x406048(0x372)]){alert(_0x406048(0x255));return;}const _0x4217b5=_0x1f8ab6[_0x406048(0x310)](),_0x416a9d=_0x4217b5[_0x406048(0x373)]||[],_0x23d404=_0x4217b5['allHeaders']||[],_0x565f07=[];_0x565f07[_0x406048(0x1aa)]([_0x406048(0x23a)]),_0x565f07[_0x406048(0x1aa)]([]),_0x565f07[_0x406048(0x1aa)](_0x23d404),_0x416a9d['forEach'](_0x3fa04f=>{const _0x538f14=_0x406048,_0x15ae87=_0x23d404[_0x538f14(0x2ed)](_0xb31375=>_0x3fa04f[_0xb31375]||'');_0x565f07['push'](_0x15ae87);});const _0x5482dd=XLSX[_0x406048(0x315)][_0x406048(0x36b)](_0x565f07);_0x5482dd['!merges']=[{'s':{'r':0x0,'c':0x0},'e':{'r':0x0,'c':_0x23d404['length']-0x1}}],_0x5482dd['A1']['s']={'font':{'bold':!![],'sz':0xe},'alignment':{'horizontal':_0x406048(0x2a6),'vertical':_0x406048(0x2a6)}};for(let _0x3b62f5=0x0;_0x3b62f5<_0x23d404[_0x406048(0x20e)];_0x3b62f5++){const _0x339d48=XLSX[_0x406048(0x315)][_0x406048(0x286)]({'r':0x2,'c':_0x3b62f5});if(!_0x5482dd[_0x339d48])continue;_0x5482dd[_0x339d48]['s']={'font':{'bold':!![]},'fill':{'fgColor':{'rgb':'F2F2F2'}},'border':{'top':{'style':_0x406048(0x2e2),'color':{'rgb':_0x406048(0x2a7)}},'bottom':{'style':_0x406048(0x2e2),'color':{'rgb':_0x406048(0x2a7)}},'left':{'style':_0x406048(0x2e2),'color':{'rgb':_0x406048(0x2a7)}},'right':{'style':_0x406048(0x2e2),'color':{'rgb':_0x406048(0x2a7)}}},'alignment':{'horizontal':_0x406048(0x2a6)}};}_0x5482dd[_0x406048(0x19a)]=_0x23d404[_0x406048(0x2ed)](_0x1ee39d=>({'wch':Math['max'](_0x1ee39d['length']+0x4,0xf)}));const _0x16d9f0=XLSX['utils'][_0x406048(0x2ad)]();XLSX[_0x406048(0x315)][_0x406048(0x2e4)](_0x16d9f0,_0x5482dd,'RR_Report'),XLSX[_0x406048(0x22e)](_0x16d9f0,_0x406048(0x1d9)+new Date()[_0x406048(0x36e)]()[_0x406048(0x1be)](0x0,0xa)+'.xlsx');}catch(_0x21e491){console[_0x406048(0x332)](_0x406048(0x24e),_0x21e491),alert(_0x406048(0x259));}}),document['getElementById'](_0x241251(0x335))['addEventListener'](_0x241251(0x2ce),async()=>{const _0x4ee0d7=_0x241251,_0x5af766=confirm(_0x4ee0d7(0x246));if(!_0x5af766)return;const _0x47b26c=firebase[_0x4ee0d7(0x1cb)]()[_0x4ee0d7(0x298)];if(!_0x47b26c)return;try{await firebase[_0x4ee0d7(0x336)]()[_0x4ee0d7(0x22a)](_0x4ee0d7(0x2cf))[_0x4ee0d7(0x208)](_0x47b26c[_0x4ee0d7(0x384)])['delete'](),console[_0x4ee0d7(0x355)](_0x4ee0d7(0x1a3)),document[_0x4ee0d7(0x1d8)]('rrReportTableHeadRow')[_0x4ee0d7(0x2df)]='',document[_0x4ee0d7(0x1d8)](_0x4ee0d7(0x1d4))['innerHTML']='',bootstrap[_0x4ee0d7(0x25d)][_0x4ee0d7(0x23d)](document[_0x4ee0d7(0x1d8)]('rrReportModal'))[_0x4ee0d7(0x31a)](),new bootstrap[(_0x4ee0d7(0x25d))](document['getElementById'](_0x4ee0d7(0x1ec)))['show']();}catch(_0x412d8a){console['error']('Failed\x20to\x20delete\x20RR\x20report:',_0x412d8a),alert(_0x4ee0d7(0x25b));}});let selectedRRRow=null;document[_0x241251(0x1d8)](_0x241251(0x1d4))['addEventListener'](_0x241251(0x2ce),_0x39af00=>{const _0x2c5580=_0x241251,_0x1580ed=_0x39af00[_0x2c5580(0x214)][_0x2c5580(0x225)]('tr');if(!_0x1580ed)return;selectedRRRow=_0x1580ed,document['querySelectorAll']('#rrReportTableBody\x20tr')[_0x2c5580(0x37e)](_0xa3d31e=>{const _0x2aa5d5=_0x2c5580;_0xa3d31e[_0x2aa5d5(0x28a)][_0x2aa5d5(0x203)](_0x2aa5d5(0x2b0));}),_0x1580ed['classList']['add'](_0x2c5580(0x2b0));const _0x3e86f8=Array[_0x2c5580(0x1f1)](document[_0x2c5580(0x1e1)]('#rrReportTableHeadRow\x20tr:nth-child(2)')[_0x2c5580(0x347)])[_0x2c5580(0x2ed)](_0x17fad7=>_0x17fad7[_0x2c5580(0x334)]['trim']()),_0x3c4ab9=Array[_0x2c5580(0x1f1)](_0x1580ed[_0x2c5580(0x347)])[_0x2c5580(0x33b)]((_0x1708d0,_0x1ff99d,_0x212f4d)=>{const _0x273577=_0x2c5580;return _0x1708d0[_0x3e86f8[_0x212f4d]]=_0x1ff99d[_0x273577(0x334)][_0x273577(0x34f)](),_0x1708d0;},{});document[_0x2c5580(0x1d8)](_0x2c5580(0x32f))['value']=_0x3c4ab9[_0x2c5580(0x20c)]||'',document['getElementById'](_0x2c5580(0x210))['value']=_0x3c4ab9['Amount']||'',document[_0x2c5580(0x1d8)](_0x2c5580(0x28b))[_0x2c5580(0x1e8)]=_0x3c4ab9[_0x2c5580(0x29f)]||'',document[_0x2c5580(0x1d8)](_0x2c5580(0x31b))[_0x2c5580(0x1e8)]=_0x3c4ab9[_0x2c5580(0x2e5)]||'',new bootstrap[(_0x2c5580(0x25d))](document[_0x2c5580(0x1d8)]('rowDetailModal'))[_0x2c5580(0x215)]();}),document[_0x241251(0x1d8)](_0x241251(0x1ac))[_0x241251(0x2e3)](_0x241251(0x2c8),async _0x310c44=>{const _0x286620=_0x241251;_0x310c44[_0x286620(0x1fe)]();if(!selectedRRRow)return;const _0x325be8=document[_0x286620(0x1d8)]('detailDepartment')[_0x286620(0x1e8)],_0x2b2c06=document[_0x286620(0x1d8)]('detailAmount')[_0x286620(0x1e8)],_0xa9ea06=document[_0x286620(0x1d8)](_0x286620(0x28b))[_0x286620(0x1e8)],_0x8d4d01=document[_0x286620(0x1d8)]('detailPR')['value'];if(!/^1\d{7}$/[_0x286620(0x192)](_0xa9ea06)){alert('‚ùó\x20P.O\x20#\x20must\x20start\x20with\x201\x20and\x20be\x20exactly\x208\x20digits.');return;}if(!/^2\d{10}$/['test'](_0x8d4d01)){alert('‚ùó\x20P.R\x20#\x20must\x20start\x20with\x202\x20and\x20be\x20exactly\x2011\x20digits.');return;}const _0x11896c=[{'name':'Department','value':_0x325be8},{'name':_0x286620(0x328),'value':_0x2b2c06},{'name':_0x286620(0x29f),'value':_0xa9ea06},{'name':_0x286620(0x2e5),'value':_0x8d4d01}],_0x1aeed9=document[_0x286620(0x1e1)](_0x286620(0x292)),_0x251a38=Array[_0x286620(0x1f1)](_0x1aeed9[_0x286620(0x347)])['map'](_0x3fe00f=>_0x3fe00f[_0x286620(0x334)][_0x286620(0x34f)]());_0x11896c[_0x286620(0x37e)](_0x2a0be8=>{const _0x3e80e5=_0x286620;if(!_0x251a38[_0x3e80e5(0x2e6)](_0x2a0be8['name'])){const _0x569094=document[_0x3e80e5(0x2de)]('th');_0x569094[_0x3e80e5(0x334)]=_0x2a0be8[_0x3e80e5(0x1ea)],_0x1aeed9[_0x3e80e5(0x1a1)](_0x569094),document['querySelectorAll'](_0x3e80e5(0x385))[_0x3e80e5(0x37e)](_0x2a0ecb=>{const _0xe7822a=_0x3e80e5,_0x181a8d=document['createElement']('td');_0x181a8d[_0xe7822a(0x334)]='',_0x2a0ecb[_0xe7822a(0x1a1)](_0x181a8d);});const _0x3ba4d9=document[_0x3e80e5(0x1e1)]('#rrReportTableHeadRow\x20tr:first-child\x20th');_0x3ba4d9[_0x3e80e5(0x31f)](_0x3e80e5(0x234),_0x1aeed9['children'][_0x3e80e5(0x20e)]);}});const _0x23be04=Array['from'](_0x1aeed9['children'])[_0x286620(0x2ed)](_0x4dea2d=>_0x4dea2d['textContent'][_0x286620(0x34f)]()),_0x2aa5dd=selectedRRRow['children'];_0x11896c['forEach'](_0x306375=>{const _0x2a147f=_0x286620,_0x28d87b=_0x23be04['indexOf'](_0x306375['name']);if(_0x28d87b>=_0x2aa5dd[_0x2a147f(0x20e)]){const _0x171ddb=document[_0x2a147f(0x2de)]('td');_0x171ddb['textContent']=_0x306375[_0x2a147f(0x1e8)],selectedRRRow[_0x2a147f(0x1a1)](_0x171ddb);}else _0x2aa5dd[_0x28d87b][_0x2a147f(0x334)]=_0x306375[_0x2a147f(0x1e8)];});const _0x61252f=[];document[_0x286620(0x379)](_0x286620(0x385))[_0x286620(0x37e)](_0x266314=>{const _0xf6a914=_0x286620,_0x4aa7a2={};Array[_0xf6a914(0x1f1)](_0x266314[_0xf6a914(0x347)])['forEach']((_0x1a2fe3,_0x18bfad)=>{_0x4aa7a2[_0x23be04[_0x18bfad]]=_0x1a2fe3['textContent']||'';}),_0x61252f[_0xf6a914(0x1aa)](_0x4aa7a2);});const _0xce93ee=firebase[_0x286620(0x1cb)]()[_0x286620(0x298)];if(_0xce93ee)try{await firebase[_0x286620(0x336)]()[_0x286620(0x22a)](_0x286620(0x2cf))['doc'](_0xce93ee['uid'])[_0x286620(0x1d5)]({'rrData':_0x61252f,'allHeaders':_0x23be04,'timestamp':firebase[_0x286620(0x336)][_0x286620(0x222)][_0x286620(0x2dc)]()}),console[_0x286620(0x355)](_0x286620(0x231));}catch(_0x3edbb6){console[_0x286620(0x332)](_0x286620(0x1d1),_0x3edbb6);}bootstrap[_0x286620(0x25d)][_0x286620(0x23d)](document[_0x286620(0x1d8)](_0x286620(0x377)))[_0x286620(0x31a)]();}),document[_0x241251(0x1d8)](_0x241251(0x29e))['addEventListener'](_0x241251(0x297),_0x5796b9=>{const _0x494150=_0x241251;if(_0x5796b9[_0x494150(0x260)]==='Enter'){const _0x5e732d=_0x5796b9[_0x494150(0x214)][_0x494150(0x1e8)][_0x494150(0x34f)]()['toLowerCase']();if(!_0x5e732d)return;const _0x17cf5a=document[_0x494150(0x379)](_0x494150(0x385));let _0x1ac260=![];const _0x1df5b9=Array[_0x494150(0x1f1)](document[_0x494150(0x379)](_0x494150(0x1c3)))['findIndex'](_0x2cc574=>_0x2cc574[_0x494150(0x334)][_0x494150(0x34f)]()[_0x494150(0x2c9)]()==='packing\x20slip');if(_0x1df5b9===-0x1){alert('Packing\x20Slip\x20column\x20not\x20found.');return;}_0x17cf5a[_0x494150(0x37e)](_0x123cb0=>{const _0x42a6d2=_0x494150,_0x150432=_0x123cb0['children'][_0x1df5b9],_0x538af1=_0x150432?.['textContent']['trim']()[_0x42a6d2(0x2c9)]();if(_0x538af1===_0x5e732d){document[_0x42a6d2(0x379)](_0x42a6d2(0x385))[_0x42a6d2(0x37e)](_0x5157e7=>_0x5157e7[_0x42a6d2(0x28a)][_0x42a6d2(0x203)]('selected-row')),_0x123cb0[_0x42a6d2(0x28a)][_0x42a6d2(0x348)](_0x42a6d2(0x2b0)),selectedRRRow=_0x123cb0;const _0x2b7425=Array['from'](document[_0x42a6d2(0x379)](_0x42a6d2(0x1c3)))[_0x42a6d2(0x2ed)](_0x23a828=>_0x23a828[_0x42a6d2(0x334)]['trim']()),_0xd64aec=Array[_0x42a6d2(0x1f1)](_0x123cb0[_0x42a6d2(0x347)])[_0x42a6d2(0x33b)]((_0x782569,_0x52b1d2,_0x5b3e1d)=>{const _0x34c1bb=_0x42a6d2;return _0x782569[_0x2b7425[_0x5b3e1d]]=_0x52b1d2[_0x34c1bb(0x334)][_0x34c1bb(0x34f)](),_0x782569;},{});document[_0x42a6d2(0x1d8)](_0x42a6d2(0x32f))['value']=_0xd64aec[_0x42a6d2(0x20c)]||'',document['getElementById'](_0x42a6d2(0x210))[_0x42a6d2(0x1e8)]=_0xd64aec[_0x42a6d2(0x328)]||'',document[_0x42a6d2(0x1d8)](_0x42a6d2(0x28b))[_0x42a6d2(0x1e8)]=_0xd64aec[_0x42a6d2(0x29f)]||'',document[_0x42a6d2(0x1d8)]('detailPR')[_0x42a6d2(0x1e8)]=_0xd64aec[_0x42a6d2(0x2e5)]||'',new bootstrap[(_0x42a6d2(0x25d))](document['getElementById']('rowDetailModal'))[_0x42a6d2(0x215)](),_0x1ac260=!![];}}),!_0x1ac260&&alert(_0x494150(0x32c));}});function showCurrencyAssignmentModal(_0x3eb970){const _0x15fbc1=_0x241251;globalRRData=_0x3eb970;const _0x46cb4a=document[_0x15fbc1(0x1d8)](_0x15fbc1(0x358));_0x46cb4a[_0x15fbc1(0x2df)]='';const _0x3f0746=[...new Set(_0x3eb970[_0x15fbc1(0x2ed)](_0x827b6c=>_0x827b6c['Supplier'])[_0x15fbc1(0x2c0)](Boolean))],_0x55ae4=[_0x15fbc1(0x369),_0x15fbc1(0x209),'JPY'];_0x3f0746[_0x15fbc1(0x37e)](_0x546ce3=>{const _0xede687=_0x15fbc1,_0x56405c=document['createElement'](_0xede687(0x1b5));_0x56405c[_0xede687(0x22f)]=_0xede687(0x251);const _0x35f1af=document['createElement'](_0xede687(0x24a));_0x35f1af['className']=_0xede687(0x2c7),_0x35f1af[_0xede687(0x334)]=_0x546ce3;const _0x43688b=document[_0xede687(0x2de)]('select');_0x43688b[_0xede687(0x22f)]=_0xede687(0x2eb),_0x43688b[_0xede687(0x31f)](_0xede687(0x1cc),_0x546ce3);const _0x3e1e39=(_0x3eb970[_0xede687(0x1d0)](_0xa17341=>_0xa17341[_0xede687(0x346)]===_0x546ce3&&_0xa17341[_0xede687(0x2ff)])||{})[_0xede687(0x2ff)]||_0xede687(0x369);_0x55ae4[_0xede687(0x37e)](_0x4b5649=>{const _0x2da90b=_0xede687,_0x3a7a85=document['createElement']('option');_0x3a7a85['value']=_0x4b5649,_0x3a7a85[_0x2da90b(0x334)]=_0x4b5649;if(_0x4b5649===_0x3e1e39)_0x3a7a85[_0x2da90b(0x29b)]=!![];_0x43688b[_0x2da90b(0x1a1)](_0x3a7a85);}),_0x56405c[_0xede687(0x1a1)](_0x35f1af),_0x56405c[_0xede687(0x1a1)](_0x43688b),_0x46cb4a['appendChild'](_0x56405c);});}document['getElementById'](_0x241251(0x35d))['addEventListener'](_0x241251(0x2ce),async _0x3e2932=>{const _0x333a83=_0x241251;_0x3e2932[_0x333a83(0x1fe)](),_0x3e2932[_0x333a83(0x1c9)]();const _0x229d1e={};document[_0x333a83(0x379)](_0x333a83(0x267))[_0x333a83(0x37e)](_0x51b404=>{const _0x3c3a36=_0x333a83,_0x512c2d=_0x51b404[_0x3c3a36(0x2ab)](_0x3c3a36(0x1cc)),_0x19b311=_0x51b404[_0x3c3a36(0x1e8)];_0x229d1e[_0x512c2d]=_0x19b311;}),globalRRData[_0x333a83(0x37e)](_0x404a6c=>{const _0x2ef06e=_0x333a83,_0x40248f=_0x404a6c[_0x2ef06e(0x346)];_0x404a6c[_0x2ef06e(0x2ff)]=_0x229d1e[_0x40248f]||'PHP';});const _0x231e11=firebase[_0x333a83(0x1cb)]()['currentUser'];if(_0x231e11){const _0xfe1257=Array['from'](new Set([...Object[_0x333a83(0x191)](globalRRData[0x0]||{}),_0x333a83(0x2ff)]));try{await firebase[_0x333a83(0x336)]()[_0x333a83(0x22a)](_0x333a83(0x2cf))[_0x333a83(0x208)](_0x231e11[_0x333a83(0x384)])[_0x333a83(0x1d5)]({'rrData':globalRRData,'allHeaders':_0xfe1257,'timestamp':firebase[_0x333a83(0x336)][_0x333a83(0x222)][_0x333a83(0x2dc)]()}),console['log'](_0x333a83(0x31c));}catch(_0x1b4362){console[_0x333a83(0x332)](_0x333a83(0x303),_0x1b4362);}}const _0x5796c6=bootstrap[_0x333a83(0x25d)]['getInstance'](document[_0x333a83(0x1d8)]('assignCurrencyModal'));if(_0x5796c6)_0x5796c6[_0x333a83(0x31a)]();updateDisplayedCurrencies(_0x229d1e);const _0xf13067=document[_0x333a83(0x1d8)](_0x333a83(0x1a7));!_0xf13067[_0x333a83(0x28a)][_0x333a83(0x341)]('show')&&new bootstrap[(_0x333a83(0x25d))](_0xf13067)[_0x333a83(0x215)]();});function updateDisplayedCurrencies(_0xc83853){const _0x49bc3b=_0x241251,_0x10c129=Array[_0x49bc3b(0x1f1)](document['querySelectorAll'](_0x49bc3b(0x1c3))),_0x40cccc=_0x10c129[_0x49bc3b(0x275)](_0x5206bf=>_0x5206bf[_0x49bc3b(0x334)][_0x49bc3b(0x34f)]()===_0x49bc3b(0x2ff)),_0x7c1e46=_0x10c129[_0x49bc3b(0x275)](_0x407d2a=>_0x407d2a['textContent'][_0x49bc3b(0x34f)]()===_0x49bc3b(0x346));if(_0x40cccc===-0x1||_0x7c1e46===-0x1)return;document[_0x49bc3b(0x379)](_0x49bc3b(0x385))[_0x49bc3b(0x37e)](_0x2aecf6=>{const _0x3be623=_0x49bc3b,_0x4d150c=_0x2aecf6[_0x3be623(0x347)],_0xfc0fb=_0x4d150c[_0x7c1e46]?.[_0x3be623(0x334)][_0x3be623(0x34f)](),_0x57d095=_0xc83853[_0xfc0fb];_0x57d095&&(_0x4d150c[_0x40cccc]['textContent']=_0x57d095);});}document[_0x241251(0x1d8)](_0x241251(0x35a))[_0x241251(0x2e3)](_0x241251(0x2ce),()=>{const _0x16babc=_0x241251,_0x5ca360=document['getElementById'](_0x16babc(0x356))[_0x16babc(0x1e8)],_0x4bbf7e=document[_0x16babc(0x1d8)](_0x16babc(0x27d))[_0x16babc(0x1e8)];if(!_0x5ca360||!_0x4bbf7e){alert(_0x16babc(0x1e5));return;}const _0x406f76=new Date(_0x5ca360+_0x16babc(0x370)),_0x52f1ab=new Date(_0x4bbf7e+'-01');_0x52f1ab['setMonth'](_0x52f1ab['getMonth']()+0x1),generateDeliveryPerformanceReport(_0x406f76,_0x52f1ab),bootstrap[_0x16babc(0x25d)][_0x16babc(0x23d)](document[_0x16babc(0x1d8)](_0x16babc(0x193)))[_0x16babc(0x31a)]();}),document[_0x241251(0x1d8)]('deliveryperformanceBtn')[_0x241251(0x2e3)](_0x241251(0x2ce),()=>{const _0x2fbb26=_0x241251;new bootstrap[(_0x2fbb26(0x25d))](document[_0x2fbb26(0x1d8)](_0x2fbb26(0x193)))['show']();});function getWorkingDays(_0x55117a,_0x4aea44){const _0x5b9a3e=_0x241251;let _0x512111=0x0;const _0x43e323=new Date(_0x55117a);_0x43e323[_0x5b9a3e(0x30c)](0x0,0x0,0x0,0x0);const _0x4df88f=new Date(_0x4aea44);_0x4df88f[_0x5b9a3e(0x30c)](0x0,0x0,0x0,0x0);while(_0x43e323<=_0x4df88f){const _0x28cb17=_0x43e323[_0x5b9a3e(0x1bb)]();if(_0x28cb17!==0x0&&_0x28cb17!==0x6)_0x512111++;_0x43e323['setDate'](_0x43e323[_0x5b9a3e(0x343)]()+0x1);}return _0x512111;}function generateDeliveryPerformanceReport(_0x3763e5,_0x1279ff){const _0x3f0837=_0x241251,_0x12ba86={},_0x2a9dec={},_0x33c203={};fullData[_0x3f0837(0x37e)](_0x2bd9cf=>{const _0x12053d=_0x3f0837,_0x58e877=new Date(_0x2bd9cf[_0x12053d(0x321)]);_0x58e877[_0x12053d(0x30c)](0x0,0x0,0x0,0x0);if(isNaN(_0x58e877['getTime']()))return;const _0x356d35=new Date(_0x3763e5),_0x25fea6=new Date(_0x1279ff);_0x356d35[_0x12053d(0x30c)](0x0,0x0,0x0,0x0),_0x25fea6[_0x12053d(0x30c)](0x0,0x0,0x0,0x0);if(_0x58e877<_0x356d35||_0x58e877>_0x25fea6)return;const _0x2a46c7=_0x2bd9cf[_0x12053d(0x346)]||_0x12053d(0x207);if(!_0x12ba86[_0x2a46c7])_0x12ba86[_0x2a46c7]=[];if(!_0x2a9dec[_0x2a46c7])_0x2a9dec[_0x2a46c7]={'OnTime':new Set(),'Delayed':new Set(),'Pending':new Set()};if(!_0x33c203[_0x2a46c7])_0x33c203[_0x2a46c7]=[];const _0x3f3834=new Date(_0x2bd9cf['Tentative\x20Delivery\x20Date']),_0x2efc85=_0x2bd9cf['Delivery\x20Date']?new Date(_0x2bd9cf[_0x12053d(0x35e)]):null;let _0xc11c2a='';if(_0x2efc85&&_0x2efc85<=_0x3f3834)_0xc11c2a=_0x12053d(0x20b);else{if(_0x2efc85&&_0x2efc85>_0x3f3834)_0xc11c2a=_0x12053d(0x264);else{if(!_0x2efc85&&_0x3f3834<new Date())_0xc11c2a='Delayed';else _0xc11c2a='Pending';}}const _0x3745a6=_0x2bd9cf[_0x12053d(0x257)]||_0x12053d(0x365);if(_0xc11c2a==='Delayed')_0x2a9dec[_0x2a46c7][_0x12053d(0x264)]['add'](_0x3745a6),_0x2a9dec[_0x2a46c7]['OnTime']['delete'](_0x3745a6),_0x2a9dec[_0x2a46c7][_0x12053d(0x29c)][_0x12053d(0x24d)](_0x3745a6);else{if(_0xc11c2a===_0x12053d(0x20b)){if(!_0x2a9dec[_0x2a46c7]['Delayed'][_0x12053d(0x242)](_0x3745a6))_0x2a9dec[_0x2a46c7][_0x12053d(0x26d)][_0x12053d(0x348)](_0x3745a6);}else _0xc11c2a===_0x12053d(0x29c)&&(!_0x2a9dec[_0x2a46c7]['Delayed'][_0x12053d(0x242)](_0x3745a6)&&!_0x2a9dec[_0x2a46c7][_0x12053d(0x26d)][_0x12053d(0x242)](_0x3745a6)&&_0x2a9dec[_0x2a46c7][_0x12053d(0x29c)][_0x12053d(0x348)](_0x3745a6));}if(_0x2efc85){const _0x4e7568=getWorkingDays(_0x58e877,_0x2efc85);_0x33c203[_0x2a46c7][_0x12053d(0x1aa)](_0x4e7568);}_0x12ba86[_0x2a46c7][_0x12053d(0x1aa)]({'orderNumber':_0x3745a6,'description':_0x2bd9cf[_0x12053d(0x37a)]||'','orderDate':_0x2bd9cf[_0x12053d(0x321)]||'','tentativeDate':_0x2bd9cf[_0x12053d(0x345)]||'','deliveryDate':_0x2bd9cf[_0x12053d(0x35e)]||'','status':_0xc11c2a});});const _0x5bac6d={};for(let _0x10717c in _0x2a9dec){const _0x34b1f4=_0x2a9dec[_0x10717c][_0x3f0837(0x26d)][_0x3f0837(0x1f8)],_0x259061=_0x2a9dec[_0x10717c][_0x3f0837(0x264)][_0x3f0837(0x1f8)],_0x52bcc5=_0x2a9dec[_0x10717c][_0x3f0837(0x29c)]['size'],_0x178e9f=_0x34b1f4+_0x259061+_0x52bcc5,_0x265f77=_0x178e9f>0x0?_0x34b1f4/_0x178e9f:0x0,_0x40085e=_0x33c203[_0x10717c][_0x3f0837(0x20e)]?_0x33c203[_0x10717c]['reduce']((_0x24a4da,_0x2625af)=>_0x24a4da+_0x2625af,0x0)/_0x33c203[_0x10717c][_0x3f0837(0x20e)]:Infinity;_0x5bac6d[_0x10717c]={'OnTime':_0x34b1f4,'Delayed':_0x259061,'Pending':_0x52bcc5,'Total':_0x178e9f,'onTimePct':_0x265f77,'avgDelivery':_0x40085e};}const _0x424cd5=Math[_0x3f0837(0x317)](...Object[_0x3f0837(0x18f)](_0x5bac6d)[_0x3f0837(0x2ed)](_0x4f8447=>_0x4f8447[_0x3f0837(0x1da)])),_0x9ac126=Math[_0x3f0837(0x317)](...Object[_0x3f0837(0x18f)](_0x5bac6d)[_0x3f0837(0x2ed)](_0x18ac68=>_0x18ac68[_0x3f0837(0x339)]===Infinity?0x0:_0x18ac68[_0x3f0837(0x339)])),_0x2fcff2={};for(let _0x4c53a1 in _0x5bac6d){const _0x9bbd01=_0x5bac6d[_0x4c53a1],_0x3f8e17=_0x424cd5?_0x9bbd01[_0x3f0837(0x1da)]/_0x424cd5:0x0,_0x473fbe=_0x9ac126&&_0x9bbd01[_0x3f0837(0x339)]!==Infinity?(_0x9ac126-_0x9bbd01[_0x3f0837(0x339)])/_0x9ac126:0x0;_0x2fcff2[_0x4c53a1]=0.6*_0x9bbd01[_0x3f0837(0x33c)]+0.3*_0x3f8e17+0.1*_0x473fbe;}const _0x4784de=Object[_0x3f0837(0x191)](_0x2fcff2)['sort']((_0xec3988,_0x3382a8)=>_0x2fcff2[_0x3382a8]-_0x2fcff2[_0xec3988])[_0x3f0837(0x1be)](0x0,0x3);let _0x460d3b=null,_0x9688e=Infinity;_0x4784de[_0x3f0837(0x37e)](_0x535fe6=>{const _0x53d3a7=_0x3f0837,_0x4b9152=_0x5bac6d[_0x535fe6][_0x53d3a7(0x339)];_0x4b9152<_0x9688e&&(_0x9688e=_0x4b9152,_0x460d3b=_0x535fe6);}),renderDeliveryPerformanceToModal(_0x12ba86,_0x5bac6d,_0x4784de,_0x33c203,_0x460d3b),new bootstrap[(_0x3f0837(0x25d))](document[_0x3f0837(0x1d8)](_0x3f0837(0x28f)))[_0x3f0837(0x215)]();}function generateDeliveryPerformanceReport(_0x2242af,_0x30fde4){const _0x35dfe3=_0x241251,_0x3d6717={},_0x291d22={},_0x12caa3={};fullData[_0x35dfe3(0x37e)](_0x352e55=>{const _0x307410=_0x35dfe3,_0x402f8c=new Date(_0x352e55[_0x307410(0x321)]);_0x402f8c[_0x307410(0x30c)](0x0,0x0,0x0,0x0);if(isNaN(_0x402f8c[_0x307410(0x23e)]()))return;const _0xc0758e=new Date(_0x2242af),_0x120628=new Date(_0x30fde4);_0xc0758e[_0x307410(0x30c)](0x0,0x0,0x0,0x0),_0x120628[_0x307410(0x30c)](0x0,0x0,0x0,0x0);if(_0x402f8c<_0xc0758e||_0x402f8c>_0x120628)return;const _0x1933cc=_0x352e55[_0x307410(0x346)]||_0x307410(0x207);if(!_0x3d6717[_0x1933cc])_0x3d6717[_0x1933cc]=[];if(!_0x291d22[_0x1933cc])_0x291d22[_0x1933cc]={'OnTime':new Set(),'Delayed':new Set(),'Pending':new Set()};if(!_0x12caa3[_0x1933cc])_0x12caa3[_0x1933cc]=[];const _0x3e8c4a=new Date(_0x352e55[_0x307410(0x345)]),_0xa4eea5=_0x352e55['Delivery\x20Date']?new Date(_0x352e55['Delivery\x20Date']):null;let _0x5c9d5f='';if(_0xa4eea5&&_0xa4eea5<=_0x3e8c4a)_0x5c9d5f=_0x307410(0x20b);else{if(_0xa4eea5&&_0xa4eea5>_0x3e8c4a)_0x5c9d5f=_0x307410(0x264);else{if(!_0xa4eea5&&_0x3e8c4a<new Date())_0x5c9d5f='Delayed';else _0x5c9d5f=_0x307410(0x29c);}}const _0x4d8c10=_0x352e55[_0x307410(0x257)]||_0x307410(0x365);if(_0x5c9d5f===_0x307410(0x264))_0x291d22[_0x1933cc]['Delayed']['add'](_0x4d8c10),_0x291d22[_0x1933cc][_0x307410(0x26d)][_0x307410(0x24d)](_0x4d8c10),_0x291d22[_0x1933cc][_0x307410(0x29c)]['delete'](_0x4d8c10);else{if(_0x5c9d5f===_0x307410(0x20b)){if(!_0x291d22[_0x1933cc]['Delayed'][_0x307410(0x242)](_0x4d8c10))_0x291d22[_0x1933cc][_0x307410(0x26d)][_0x307410(0x348)](_0x4d8c10);}else _0x5c9d5f==='Pending'&&(!_0x291d22[_0x1933cc]['Delayed'][_0x307410(0x242)](_0x4d8c10)&&!_0x291d22[_0x1933cc][_0x307410(0x26d)][_0x307410(0x242)](_0x4d8c10)&&_0x291d22[_0x1933cc][_0x307410(0x29c)][_0x307410(0x348)](_0x4d8c10));}if(_0xa4eea5){const _0x531492=getWorkingDays(_0x402f8c,_0xa4eea5);_0x12caa3[_0x1933cc][_0x307410(0x1aa)](_0x531492);}_0x3d6717[_0x1933cc][_0x307410(0x1aa)]({'orderNumber':_0x4d8c10,'description':_0x352e55[_0x307410(0x37a)]||'','orderDate':_0x352e55[_0x307410(0x321)]||'','tentativeDate':_0x352e55[_0x307410(0x345)]||'','deliveryDate':_0x352e55[_0x307410(0x35e)]||'','status':_0x5c9d5f});});const _0x5249f8={};for(let _0x16f90f in _0x291d22){const _0x5b7cf9=_0x291d22[_0x16f90f][_0x35dfe3(0x26d)]['size'],_0x2ba87b=_0x291d22[_0x16f90f]['Delayed']['size'],_0x3af8b2=_0x291d22[_0x16f90f][_0x35dfe3(0x29c)]['size'],_0x1e2a8a=_0x5b7cf9+_0x2ba87b+_0x3af8b2,_0x4cbe30=_0x1e2a8a>0x0?_0x5b7cf9/_0x1e2a8a:0x0,_0x3e64ae=_0x12caa3[_0x16f90f][_0x35dfe3(0x20e)]?_0x12caa3[_0x16f90f]['reduce']((_0x398047,_0x3c84ad)=>_0x398047+_0x3c84ad,0x0)/_0x12caa3[_0x16f90f][_0x35dfe3(0x20e)]:Infinity;_0x5249f8[_0x16f90f]={'OnTime':_0x5b7cf9,'Delayed':_0x2ba87b,'Pending':_0x3af8b2,'Total':_0x1e2a8a,'onTimePct':_0x4cbe30,'avgDelivery':_0x3e64ae};}const _0x5051f4=Math[_0x35dfe3(0x317)](...Object[_0x35dfe3(0x18f)](_0x5249f8)['map'](_0x3d2faf=>_0x3d2faf[_0x35dfe3(0x1da)])),_0x322968=Math[_0x35dfe3(0x317)](...Object[_0x35dfe3(0x18f)](_0x5249f8)[_0x35dfe3(0x2ed)](_0x22ee31=>_0x22ee31[_0x35dfe3(0x339)]===Infinity?0x0:_0x22ee31[_0x35dfe3(0x339)])),_0xde539c={};for(let _0x44bd51 in _0x5249f8){const _0x60a54=_0x5249f8[_0x44bd51],_0x4f5038=_0x5051f4?_0x60a54[_0x35dfe3(0x1da)]/_0x5051f4:0x0,_0xa4f63a=_0x322968&&_0x60a54[_0x35dfe3(0x339)]!==Infinity?(_0x322968-_0x60a54['avgDelivery'])/_0x322968:0x0;_0xde539c[_0x44bd51]=0.6*_0x60a54['onTimePct']+0.3*_0x4f5038+0.1*_0xa4f63a;}const _0x337bdc=Object['keys'](_0xde539c)[_0x35dfe3(0x296)]((_0x815fc7,_0x432ddc)=>_0xde539c[_0x432ddc]-_0xde539c[_0x815fc7])[_0x35dfe3(0x1be)](0x0,0x3),_0xe6b1bc=Object[_0x35dfe3(0x191)](_0xde539c)['sort']((_0x5c63ed,_0x131b81)=>_0xde539c[_0x5c63ed]-_0xde539c[_0x131b81])[_0x35dfe3(0x1be)](0x0,0x3);let _0x20a077=null,_0x2ee3b7=Infinity;_0x337bdc[_0x35dfe3(0x37e)](_0x19760c=>{const _0x28923b=_0x5249f8[_0x19760c]['avgDelivery'];_0x28923b<_0x2ee3b7&&(_0x2ee3b7=_0x28923b,_0x20a077=_0x19760c);}),renderDeliveryPerformanceToModal(_0x3d6717,_0x5249f8,_0x337bdc,_0xe6b1bc,_0x12caa3,_0x20a077),new bootstrap[(_0x35dfe3(0x25d))](document[_0x35dfe3(0x1d8)]('deliveryPerformanceModal'))[_0x35dfe3(0x215)]();}function renderDeliveryPerformanceToModal(_0x5a6e5a,_0x83ae63,_0x3dbfec,_0x53b1fc,_0x2b0421,_0x1e4f76){const _0x108286=_0x241251,_0x357498=document[_0x108286(0x1d8)]('deliveryPerformanceContent');_0x357498['innerHTML']='';if(!Object[_0x108286(0x191)](_0x5a6e5a)[_0x108286(0x20e)]){_0x357498[_0x108286(0x2df)]=_0x108286(0x2a9);return;}Object[_0x108286(0x2ca)](_0x5a6e5a)[_0x108286(0x37e)](([_0x5a2afb,_0x368319])=>{const _0xf077fd=_0x108286,_0x578eb2=_0x83ae63[_0x5a2afb],_0x21c926=Math['round'](_0x578eb2[_0xf077fd(0x26d)]/_0x578eb2[_0xf077fd(0x1da)]*0x64);let _0x2a9f34=_0xf077fd(0x18e),_0x132818='';if(_0x3dbfec[0x0]===_0x5a2afb)_0x132818='<span\x20class=\x22badge\x20bg-warning\x20text-dark\x22>Top\x201</span>';else{if(_0x3dbfec[0x1]===_0x5a2afb)_0x132818=_0xf077fd(0x312);else{if(_0x3dbfec[0x2]===_0x5a2afb)_0x132818=_0xf077fd(0x2e0);}}if(_0x53b1fc[0x0]===_0x5a2afb)_0x132818+='\x20<span\x20class=\x22badge\x20bg-danger\x20text-light\x22>Bottom\x201</span>';else{if(_0x53b1fc[0x1]===_0x5a2afb)_0x132818+=_0xf077fd(0x197);else{if(_0x53b1fc[0x2]===_0x5a2afb)_0x132818+='\x20<span\x20class=\x22badge\x20bg-danger\x20text-light\x22>Bottom\x203</span>';}}let _0x437561='';if(_0x1e4f76===_0x5a2afb)_0x437561='<span\x20class=\x22badge\x20bg-info\x20text-dark\x20ms-1\x22>Fastest</span>';const _0x367683=_0x2b0421[_0x5a2afb][_0xf077fd(0x20e)]?(_0x2b0421[_0x5a2afb]['reduce']((_0x12ee5f,_0x3e2643)=>_0x12ee5f+_0x3e2643,0x0)/_0x2b0421[_0x5a2afb][_0xf077fd(0x20e)])['toFixed'](0x1):'-',_0x1c72ca=document[_0xf077fd(0x2de)](_0xf077fd(0x1b5));_0x1c72ca[_0xf077fd(0x22f)]='mb-2\x20p-3\x20rounded\x20bg-light\x20'+_0x2a9f34,_0x1c72ca[_0xf077fd(0x2df)]=_0xf077fd(0x2e1)+_0x5a2afb+'\x20'+_0x132818+'\x20'+_0x437561+_0xf077fd(0x213)+_0x578eb2[_0xf077fd(0x26d)]+_0xf077fd(0x195)+_0x578eb2[_0xf077fd(0x264)]+'</span></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span><strong>Pending:</strong>\x20<span\x20class=\x22text-warning\x20text-dark\x22>'+_0x578eb2[_0xf077fd(0x29c)]+'</span></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span><strong>Total\x20Orders:</strong>\x20'+_0x578eb2[_0xf077fd(0x1da)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span><strong>Avg\x20Delivery:</strong>\x20'+_0x367683+'\x20days</span>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22progress\x22\x20style=\x22height:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22progress-bar\x20bg-success\x22\x20role=\x22progressbar\x22\x20style=\x22width:\x20'+_0x21c926+_0xf077fd(0x294)+_0x21c926+_0xf077fd(0x1f3);const _0x4b9f15=document[_0xf077fd(0x2de)](_0xf077fd(0x362));_0x4b9f15[_0xf077fd(0x22f)]=_0xf077fd(0x2b8),_0x4b9f15['innerHTML']=_0xf077fd(0x1f9)+_0x368319[_0xf077fd(0x2ed)](_0x591a2d=>_0xf077fd(0x36c)+_0x591a2d[_0xf077fd(0x306)]+_0xf077fd(0x245)+_0x591a2d[_0xf077fd(0x212)]+_0xf077fd(0x245)+(_0x591a2d[_0xf077fd(0x2c3)]||'-')+_0xf077fd(0x245)+(_0x591a2d[_0xf077fd(0x2f6)]||'-')+_0xf077fd(0x245)+(formatDateDisplay(_0x591a2d[_0xf077fd(0x36f)])||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><span\x20class=\x22badge\x20'+getStatusBadgeClass(_0x591a2d[_0xf077fd(0x1e6)])+'\x22>'+_0x591a2d['status']+_0xf077fd(0x25a))[_0xf077fd(0x333)]('')+_0xf077fd(0x340),_0x357498[_0xf077fd(0x1a1)](_0x1c72ca),_0x357498[_0xf077fd(0x1a1)](_0x4b9f15);});}function getStatusBadgeClass(_0x104b53){const _0x45e1c7=_0x241251;switch(_0x104b53){case'On\x20Time':return _0x45e1c7(0x2b2);case _0x45e1c7(0x264):return _0x45e1c7(0x204);case _0x45e1c7(0x29c):return _0x45e1c7(0x1eb);default:return _0x45e1c7(0x33d);}}function isValidDate(_0x341c0d){const _0x39ddac=_0x241251,_0x423648=new Date(_0x341c0d);return!isNaN(_0x423648[_0x39ddac(0x23e)]());}function formatDateDisplay(_0xb80399){const _0x54eb2a=_0x241251;if(!_0xb80399)return'';if(!isNaN(_0xb80399)&&Number(_0xb80399)>0x3b&&Number(_0xb80399)<0xea60){const _0x366cff=new Date(0x76b,0xb,0x1e),_0x30ed91=new Date(_0x366cff['getTime']()+Number(_0xb80399)*0x5265c00);return _0x30ed91[_0x54eb2a(0x1b3)](_0x54eb2a(0x357),{'year':_0x54eb2a(0x1f6),'month':'long','day':_0x54eb2a(0x1f6)});}if(Object['prototype'][_0x54eb2a(0x304)]['call'](_0xb80399)===_0x54eb2a(0x378)&&!isNaN(_0xb80399))return _0xb80399['toLocaleDateString'](_0x54eb2a(0x357),{'year':'numeric','month':'long','day':_0x54eb2a(0x1f6)});if(/^\d{4}-\d{2}-\d{2}$/[_0x54eb2a(0x192)](_0xb80399)){const [_0x526d47,_0x29aeae,_0x45a177]=_0xb80399[_0x54eb2a(0x2a0)]('-'),_0x448530=new Date(_0x526d47+'-'+_0x29aeae+'-'+_0x45a177);return _0x448530['toLocaleDateString']('en-US',{'year':_0x54eb2a(0x1f6),'month':'long','day':_0x54eb2a(0x1f6)});}if(/^\d{2}\/\d{2}\/\d{4}$/[_0x54eb2a(0x192)](_0xb80399)){const [_0xff2c65,_0xd31b45,_0x2fa290]=_0xb80399[_0x54eb2a(0x2a0)]('/'),_0x38415a=new Date(_0x2fa290+'-'+_0xff2c65+'-'+_0xd31b45);return _0x38415a['toLocaleDateString']('en-US',{'year':_0x54eb2a(0x1f6),'month':_0x54eb2a(0x353),'day':_0x54eb2a(0x1f6)});}return _0xb80399;}document[_0x241251(0x1d8)](_0x241251(0x1fc))['addEventListener']('click',async()=>{const _0x34d5bd=_0x241251,_0x170b0f=firebase['auth']()[_0x34d5bd(0x298)];if(_0x170b0f)try{await firebase['firestore']()[_0x34d5bd(0x22a)](_0x34d5bd(0x237))[_0x34d5bd(0x208)](_0x170b0f['uid'])[_0x34d5bd(0x20f)]({'sessionActive':![],'lastSession':firebase[_0x34d5bd(0x336)][_0x34d5bd(0x222)]['serverTimestamp']()});}catch(_0x164092){console[_0x34d5bd(0x332)]('Failed\x20to\x20update\x20sessionActive\x20on\x20logout:',_0x164092);}await firebase[_0x34d5bd(0x1cb)]()[_0x34d5bd(0x1a5)](),window['location'][_0x34d5bd(0x311)]=_0x34d5bd(0x1b9);});function resetTimer(){clearTimeout(inactivityTimer),inactivityTimer=setTimeout(()=>{logoutUser();},0x5*0x3c*0x3e8);}async function logoutUser(){const _0x44ce02=_0x241251;alert(_0x44ce02(0x388));const _0x350542=firebase['auth']()[_0x44ce02(0x298)];if(_0x350542)try{await firebase[_0x44ce02(0x336)]()[_0x44ce02(0x22a)](_0x44ce02(0x237))[_0x44ce02(0x208)](_0x350542['uid'])[_0x44ce02(0x20f)]({'sessionActive':![],'sessionId':null,'lastSession':firebase[_0x44ce02(0x336)][_0x44ce02(0x222)][_0x44ce02(0x2dc)]()});}catch(_0x5726d0){console[_0x44ce02(0x332)]('Failed\x20to\x20update\x20session\x20info\x20on\x20logout:',_0x5726d0);}localStorage[_0x44ce02(0x1d3)](_0x44ce02(0x368)),sessionStorage[_0x44ce02(0x279)]();try{await firebase[_0x44ce02(0x1cb)]()[_0x44ce02(0x1a5)]();}catch(_0x11ff65){console['error'](_0x44ce02(0x322),_0x11ff65[_0x44ce02(0x285)]);}window[_0x44ce02(0x2d8)][_0x44ce02(0x311)]=_0x44ce02(0x1b9);}window[_0x241251(0x2e3)](_0x241251(0x2a8),resetTimer),window[_0x241251(0x2e3)](_0x241251(0x307),resetTimer),window[_0x241251(0x2e3)](_0x241251(0x2fa),resetTimer),window[_0x241251(0x2e3)]('click',resetTimer),resetTimer(),window['addEventListener'](_0x241251(0x23f),async()=>{const _0x5f1533=_0x241251,_0x2f8205=firebase[_0x5f1533(0x1cb)]()[_0x5f1533(0x298)];if(_0x2f8205)try{await firebase[_0x5f1533(0x336)]()[_0x5f1533(0x22a)](_0x5f1533(0x237))['doc'](_0x2f8205[_0x5f1533(0x384)])[_0x5f1533(0x20f)]({'lastSession':firebase[_0x5f1533(0x336)][_0x5f1533(0x222)][_0x5f1533(0x2dc)]()});}catch(_0x30866d){console[_0x5f1533(0x1f2)](_0x5f1533(0x232),_0x30866d);}}),document['addEventListener'](_0x241251(0x26f),()=>{const _0x384edd=_0x241251,_0x81b756=document[_0x384edd(0x1d8)]('toggleSidebar'),_0xed6711=document[_0x384edd(0x1d8)](_0x384edd(0x223));_0x81b756&&_0xed6711?_0x81b756[_0x384edd(0x2e3)](_0x384edd(0x2ce),_0x2413c3=>{const _0xab548f=_0x384edd;_0x2413c3[_0xab548f(0x1fe)](),_0xed6711[_0xab548f(0x28a)][_0xab548f(0x309)](_0xab548f(0x2da)),_0xed6711['classList'][_0xab548f(0x309)](_0xab548f(0x2bb)),_0xed6711[_0xab548f(0x28a)][_0xab548f(0x309)](_0xab548f(0x1e7));}):console['warn'](_0x384edd(0x1c5));});
</script>





</body>
</html>


